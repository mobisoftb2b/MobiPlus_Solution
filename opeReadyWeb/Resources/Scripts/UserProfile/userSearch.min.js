function beginRequestHandler() { } function endRequestHandler(a, b) { } function deleteSpecFormatter(a, b, c) { var d; try { d = new Image(32, 32); if (c.UserID != "1") { $(d).attr("src", "/opeReady/Resources/icons/trash.png"); $(d).attr("style", "cursor:pointer") } else { $(d).attr("src", "/opeReady/Resources/images/empty.png") } } catch (e) { } return d.outerHTML || (new XMLSerializer).serializeToString(d) } var rowCount; var userSearch = {}; userSearch.Init = function () { }; userSearch.CreateUserCollectionGrid = function (a) { var b; if ($.cookie("lang")) { if ($.cookie("lang") == "he-IL" || $.cookie("lang") == "ar") b = "rtl"; else b = "ltr" } $("#divResultPanel").block({ css: { border: "0px" }, overlayCSS: { backgroundColor: "#ffffff", opacity: .7 }, message: "" }); $("#tblUserDetailsGrid").jqGrid({ direction: b, datatype: function (a) { userSearch.getUserCollectionData() }, height: 375, colNames: [$("#hidUserSearch_Grid_UserName").text(), $("#hidUserSearch_Grid_FirstName").text(), $("#hidUserSearch_Grid_LastName").text(), $("#hidUserSearch_Grid_User_OrganizationID").text(), $("#hidUserSearch_Grid_UserEmail").text(), "", "", "UserID"], colModel: [{ name: "UserName", index: "UserName", sortable: true, sorttype: "text", width: 120 }, { name: "User_FirstName", index: "User_FirstName", sortable: true, sorttype: "text", width: 120 }, { name: "User_LastName", index: "User_LastName", sorttype: "int", sortable: true, align: "center", width: 120 }, { name: "User_OrganizationID", index: "User_OrganizationID", sortable: true, sorttype: "text", width: 180 }, { name: "User_Email", index: "User_Email", sortable: true, sorttype: "int", align: "center", width: 150 }, { name: "EditUser", index: "EditUser", sortable: false, edittype: "image", formatter: editFormatter, width: 35, align: "center" }, { name: "DelUser", index: "DelUser", sortable: false, edittype: "image", formatter: deleteSpecFormatter, width: 45, align: "center" }, { name: "UserID", hidden: "true"}], viewrecords: true, autoencode: false, rowNum: 1e4, loadonce: true, altRows: false, hoverrows: false, pager: "#pgrUserDetailsGrid", recordpos: "left", pgbuttons: false, pginput: false, gridComplete: function () { $(this).setGridParam({ datatype: "local", selarrrow: "false" }); if (rowCount == $(this).getGridParam("records")) { $("#waitplease").css({ display: "none" }); $("#divResultPanel").unblock(); rowCount = 0 } }, onCellSelect: function (a, b, c, d) { switch (b) { case 5: userSearch.DefineUserCollection_Open($(this).getRowData(a).UserID); break; case 6: if ($(this).getRowData(a).UserID != "1") return userSearch.DefineUserCollection_Delete($(this).getRowData(a).UserID); break } return false }, ondblClickRow: function (a, b, c, d) { userSearch.DefineUserCollection_Open($(this).getRowData(a).UserID) } }) }; userSearch.getUserCollectionData = function () { var a = { UserID: $("#txtUserID").val() == "" ? 0 : $("#txtUserID").val(), UserName: $("#txtUserName").val(), User_FirstName: $("#txtFirstName").val(), User_LastName: $("#txtLastName").val() }; PQ.Admin.WebService.UserProfileService.User_SelectAll(a, function (a, b) { userSearch.ReceivedUserCollectionData(JSON.parse(getMain(a)).rows) }, function (a, b) { return false }) }; userSearch.ReceivedUserCollectionData = function (a) { var b = $("#tblUserDetailsGrid"); b.clearGridData(); rowCount = a.length; if (!rowCount) { $("#divResultPanel").unblock(); setTimeout(function () { $("#waitplease").css({ display: "none" }) }, 500) } for (var c = 0; c < a.length; c++) b.addRowData(c + 1, a[c]) }; userSearch.DefineUserCollection_Open = function (a) { if (a) { $("#waitplease").css({ display: "block" }); window.location.href = "Users.aspx?usid=" + a } }; userSearch.SetUserNameArray = function (a) { try { $("#txtUserName").autocomplete({ source: function (a, b) { PQ.Admin.WebService.UserProfileService.GetUserNameList(a.term, function (a) { if (a) { b($.map(getMain(a), function (a) { return { value: a.UserName} })) } }, function (a) { }, null) }, minLength: 1 }) } catch (b) { return false } }; userSearch.SetUserFirstNameArray = function (a) { try { $("#txtFirstName").autocomplete({ source: function (a, b) { PQ.Admin.WebService.UserProfileService.GetUserFirstNameList(a.term, function (a) { if (a) { b($.map(getMain(a), function (a) { return { value: a.User_FirstName} })) } }, function (a) { }, null) }, minLength: 1 }) } catch (b) { return false } }; userSearch.SetUserLastNameArray = function (a) { try { $("#txtLastName").autocomplete({ source: function (a, b) { PQ.Admin.WebService.UserProfileService.GetUserLastNameList(a.term, function (a) { if (a) { b($.map(getMain(a), function (a) { return { value: a.User_LastName} })) } }, function (a) { }, null) }, minLength: 1 }) } catch (b) { return false } }; userSearch.DefineUserCollection_Delete = function (a) { $("#ConfirmDeleteAttachment").dialog({ autoOpen: true, modal: true, resizable: false, closeOnEscape: true, height: 150, open: function (a, b) { $(this).parent().appendTo("form") }, buttons: { Ok: function (b) { b.preventDefault(); try { PQ.Admin.WebService.UserProfileService.UserDetails_Delete(a, function (a) { if (a) { $("#waitplease").css({ display: "block" }); $("#tblUserDetailsGrid").GridUnload(); userSearch.CreateUserCollectionGrid(); $("#ConfirmDeleteAttachment").dialog("destroy") } }, this.ExecuteFailResult) } catch (b) { return false } return false }, Cancel: function (a) { a.preventDefault(); $(this).dialog("destroy"); return false } } }); return false }; Sys.WebForms.PageRequestManager.getInstance().add_endRequest(endRequestHandler); Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(beginRequestHandler)