"use strict";(function(){if(jQuery&&jQuery.jstree){return}var a=false,b=false,c=false;(function(d){d.vakata={};d.vakata.css={get_css:function(a,b,c){a=a.toLowerCase();var d=c.cssRules||c.rules,e=0;do{if(d.length&&e>d.length+5){return false}if(d[e].selectorText&&d[e].selectorText.toLowerCase()==a){if(b===true){if(c.removeRule){c.removeRule(e)}if(c.deleteRule){c.deleteRule(e)}return true}else{return d[e]}}}while(d[++e]);return false},add_css:function(a,b){if(d.jstree.css.get_css(a,false,b)){return false}if(b.insertRule){b.insertRule(a+" { }",0)}else{b.addRule(a,null,0)}return d.vakata.css.get_css(a)},remove_css:function(a,b){return d.vakata.css.get_css(a,true,b)},add_sheet:function(a){var b=false,c=true;if(a.str){if(a.title){b=d("style[id='"+a.title+"-stylesheet']")[0]}if(b){c=false}else{b=document.createElement("style");b.setAttribute("type","text/css");if(a.title){b.setAttribute("id",a.title+"-stylesheet")}}if(b.styleSheet){if(c){document.getElementsByTagName("head")[0].appendChild(b);b.styleSheet.cssText=a.str}else{b.styleSheet.cssText=b.styleSheet.cssText+" "+a.str}}else{b.appendChild(document.createTextNode(a.str));document.getElementsByTagName("head")[0].appendChild(b)}return b.sheet||b.styleSheet}if(a.url){if(document.createStyleSheet){try{b=document.createStyleSheet(a.url)}catch(e){}}else{b=document.createElement("link");b.rel="stylesheet";b.type="text/css";b.media="all";b.href=a.url;document.getElementsByTagName("head")[0].appendChild(b);return b.styleSheet}}}};var e=[],f=-1,g={},h={};d.fn.jstree=function(a){var b=typeof a=="string",c=Array.prototype.slice.call(arguments,1),f=this;if(b){if(a.substring(0,1)=="_"){return f}this.each(function(){var b=e[d.data(this,"jstree-instance-id")],g=b&&d.isFunction(b[a])?b[a].apply(b,c):b;if(typeof g!=="undefined"&&(a.indexOf("is_")===0||g!==true&&g!==false)){f=g;return false}})}else{this.each(function(){var b=d.data(this,"jstree-instance-id"),f=[],h=a?d.extend({},true,a):{},i=d(this),j=false,k=[];f=f.concat(c);if(i.data("jstree")){f.push(i.data("jstree"))}h=f.length?d.extend.apply(null,[true,h].concat(f)):h;if(typeof b!=="undefined"&&e[b]){e[b].destroy()}b=parseInt(e.push({}),10)-1;d.data(this,"jstree-instance-id",b);h.plugins=d.isArray(h.plugins)?h.plugins:d.jstree.defaults.plugins.slice();h.plugins.unshift("core");h.plugins=h.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");j=d.extend(true,{},d.jstree.defaults,h);j.plugins=h.plugins;d.each(g,function(a,b){if(d.inArray(a,j.plugins)===-1){j[a]=null;delete j[a]}else{k.push(a)}});j.plugins=k;e[b]=new d.jstree._instance(b,d(this).addClass("jstree jstree-"+b),j);d.each(e[b]._get_settings().plugins,function(a,c){e[b].data[c]={}});d.each(e[b]._get_settings().plugins,function(a,c){if(g[c]){g[c].__init.apply(e[b])}});setTimeout(function(){e[b].init()},0)})}return f};d.jstree={defaults:{plugins:[]},_focused:function(){return e[f]||null},_reference:function(a){if(e[a]){return e[a]}var b=d(a);if(!b.length&&typeof a==="string"){b=d("#"+a)}if(!b.length){return null}return e[b.closest(".jstree").data("jstree-instance-id")]||null},_instance:function(a,b,c){this.data={core:{}};this.get_settings=function(){return d.extend(true,{},c)};this._get_settings=function(){return c};this.get_index=function(){return a};this.get_container=function(){return b};this.get_container_ul=function(){return b.children("ul:eq(0)")};this._set_settings=function(a){c=d.extend(true,{},c,a)}},_fn:{},plugin:function(a,b){b=d.extend({},{__init:d.noop,__destroy:d.noop,_fn:{},defaults:false},b);g[a]=b;d.jstree.defaults[a]=b.defaults;d.each(b._fn,function(b,c){c.plugin=a;c.old=d.jstree._fn[b];d.jstree._fn[b]=function(){var a,e=c,f=Array.prototype.slice.call(arguments),g=new d.Event("before.jstree"),h=false;if(this.data.core.locked===true&&b!=="unlock"&&b!=="is_locked"){return}do{if(e&&e.plugin&&d.inArray(e.plugin,this._get_settings().plugins)!==-1){break}e=e.old}while(e);if(!e){return}if(b.indexOf("_")===0){a=e.apply(this,f)}else{a=this.get_container().triggerHandler(g,{func:b,inst:this,args:f,plugin:e.plugin});if(a===false){return}if(typeof a!=="undefined"){f=a}a=e.apply(d.extend({},this,{__callback:function(a){this.get_container().triggerHandler(b+".jstree",{inst:this,args:f,rslt:a,rlbk:h})},__rollback:function(){h=this.get_rollback();return h},__call_old:function(a){return e.old.apply(this,a?Array.prototype.slice.call(arguments,1):f)}}),f)}return a};d.jstree._fn[b].old=c.old;d.jstree._fn[b].plugin=a})},rollback:function(a){if(a){if(!d.isArray(a)){a=[a]}d.each(a,function(a,b){e[b.i].set_rollback(b.h,b.d)})}}};d.jstree._fn=d.jstree._instance.prototype={};d(function(){var e=navigator.userAgent.toLowerCase(),f=(e.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/)||[0,"0"])[1],g=""+".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } "+".jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } "+".jstree-rtl li { margin-left:0; margin-right:18px; } "+".jstree > ul > li { margin-left:0px; } "+".jstree-rtl > ul > li { margin-right:0px; } "+".jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } "+".jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } "+".jstree a:focus { outline: none; } "+".jstree a > ins { height:16px; width:16px; } "+".jstree a > .jstree-icon { margin-right:3px; } "+".jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } "+"li.jstree-open > ul { display:block; } "+"li.jstree-closed > ul { display:none; } ";if(/msie/.test(e)&&parseInt(f,10)==6){a=true;try{document.execCommand("BackgroundImageCache",false,true)}catch(h){}g+=""+".jstree li { height:18px; margin-left:0; margin-right:0; } "+".jstree li li { margin-left:18px; } "+".jstree-rtl li li { margin-left:0px; margin-right:18px; } "+"li.jstree-open ul { display:block; } "+"li.jstree-closed ul { display:none !important; } "+".jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } "+".jstree li a ins { height:16px; width:16px; margin-right:3px; } "+".jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "}if(/msie/.test(e)&&parseInt(f,10)==7){b=true;g+=".jstree li a { border-width:0 !important; padding:0px 2px !important; } "}if(!/compatible/.test(e)&&/mozilla/.test(e)&&parseFloat(f,10)<1.9){c=true;g+=""+".jstree ins { display:-moz-inline-box; } "+".jstree li { line-height:12px; } "+".jstree a { display:-moz-inline-box; } "+".jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } "}d.vakata.css.add_sheet({str:g,title:"jstree"})});d.jstree.plugin("core",{__init:function(){this.data.core.locked=false;this.data.core.to_open=this.get_settings().core.initially_open;this.data.core.to_load=this.get_settings().core.initially_load},defaults:{html_titles:false,animation:500,initially_open:[],initially_load:[],open_parents:true,notify_plugins:true,rtl:false,load_open:false,strings:{loading:"Loading ...",new_node:"New node",multiple_selection:"Multiple selection"}},_fn:{init:function(){this.set_focus();if(this._get_settings().core.rtl){this.get_container().addClass("jstree-rtl").css("direction","rtl")}this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>"+this._get_string("loading")+"</a></li></ul>");this.data.core.li_height=this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height()||18;this.get_container().delegate("li > ins","click.jstree",d.proxy(function(a){var b=d(a.target);if(b.is("ins")&&a.pageY-b.offset().top<this.data.core.li_height){this.toggle_node(b)}},this)).bind("mousedown.jstree",d.proxy(function(){this.set_focus()},this)).bind("dblclick.jstree",function(a){var b;if(document.selection&&document.selection.empty){document.selection.empty()}else{if(window.getSelection){b=window.getSelection();try{b.removeAllRanges();b.collapse()}catch(c){}}}});if(this._get_settings().core.notify_plugins){this.get_container().bind("load_node.jstree",d.proxy(function(a,b){var c=this._get_node(b.rslt.obj),e=this;if(c===-1){c=this.get_container_ul()}if(!c.length){return}c.find("li").each(function(){var a=d(this);if(a.data("jstree")){d.each(a.data("jstree"),function(b,c){if(e.data[b]&&d.isFunction(e["_"+b+"_notify"])){e["_"+b+"_notify"].call(e,a,c)}})}})},this))}if(this._get_settings().core.load_open){this.get_container().bind("load_node.jstree",d.proxy(function(a,b){var c=this._get_node(b.rslt.obj),e=this;if(c===-1){c=this.get_container_ul()}if(!c.length){return}c.find("li.jstree-open:not(:has(ul))").each(function(){e.load_node(this,d.noop,d.noop)})},this))}this.__callback();this.load_node(-1,function(){this.loaded();this.reload_nodes()})},destroy:function(){var a,b=this.get_index(),c=this._get_settings(),h=this;d.each(c.plugins,function(a,b){try{g[b].__destroy.apply(h)}catch(c){}});this.__callback();if(this.is_focused()){for(a in e){if(e.hasOwnProperty(a)&&a!=b){e[a].set_focus();break}}}if(b===f){f=-1}this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree-instance-id").find("[class^='jstree']").andSelf().attr("class",function(){return this.className.replace(/jstree[^ ]*|$/ig,"")});d(document).unbind(".jstree-"+b).undelegate(".jstree-"+b);e[b]=null;delete e[b]},_core_notify:function(a,b){if(b.opened){this.open_node(a,false,true)}},lock:function(){this.data.core.locked=true;this.get_container().children("ul").addClass("jstree-locked").css("opacity","0.7");this.__callback({})},unlock:function(){this.data.core.locked=false;this.get_container().children("ul").removeClass("jstree-locked").css("opacity","1");this.__callback({})},is_locked:function(){return this.data.core.locked},save_opened:function(){var a=this;this.data.core.to_open=[];this.get_container_ul().find("li.jstree-open").each(function(){if(this.id){a.data.core.to_open.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}});this.__callback(a.data.core.to_open)},save_loaded:function(){},reload_nodes:function(a){var b=this,c=true,e=[],f=[];if(!a){this.data.core.reopen=false;this.data.core.refreshing=true;this.data.core.to_open=d.map(d.makeArray(this.data.core.to_open),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});this.data.core.to_load=d.map(d.makeArray(this.data.core.to_load),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});if(this.data.core.to_open.length){this.data.core.to_load=this.data.core.to_load.concat(this.data.core.to_open)}}if(this.data.core.to_load.length){d.each(this.data.core.to_load,function(a,b){if(b=="#"){return true}if(d(b).length){e.push(b)}else{f.push(b)}});if(e.length){this.data.core.to_load=f;d.each(e,function(a,d){if(!b._is_loaded(d)){b.load_node(d,function(){b.reload_nodes(true)},function(){b.reload_nodes(true)});c=false}})}}if(this.data.core.to_open.length){d.each(this.data.core.to_open,function(a,c){b.open_node(c,false,true)})}if(c){if(this.data.core.reopen){clearTimeout(this.data.core.reopen)}this.data.core.reopen=setTimeout(function(){b.__callback({},b)},50);this.data.core.refreshing=false;this.reopen()}},reopen:function(){var a=this;if(this.data.core.to_open.length){d.each(this.data.core.to_open,function(b,c){a.open_node(c,false,true)})}this.__callback({})},refresh:function(a){var b=this;this.save_opened();if(!a){a=-1}a=this._get_node(a);if(!a){a=-1}if(a!==-1){a.children("UL").remove()}else{this.get_container_ul().empty()}this.load_node(a,function(){b.__callback({obj:a});b.reload_nodes()})},loaded:function(){this.__callback()},set_focus:function(){if(this.is_focused()){return}var a=d.jstree._focused();if(a){a.unset_focus()}this.get_container().addClass("jstree-focused");f=this.get_index();this.__callback()},is_focused:function(){return f==this.get_index()},unset_focus:function(){if(this.is_focused()){this.get_container().removeClass("jstree-focused");f=-1}this.__callback()},_get_node:function(a){var b=d(a,this.get_container());if(b.is(".jstree")||a==-1){return-1}b=b.closest("li",this.get_container());return b.length?b:false},_get_next:function(a,b){a=this._get_node(a);if(a===-1){return this.get_container().find("> ul > li:first-child")}if(!a.length){return false}if(b){return a.nextAll("li").size()>0?a.nextAll("li:eq(0)"):false}if(a.hasClass("jstree-open")){return a.find("li:eq(0)")}else if(a.nextAll("li").size()>0){return a.nextAll("li:eq(0)")}else{return a.parentsUntil(".jstree","li").next("li").eq(0)}},_get_prev:function(a,b){a=this._get_node(a);if(a===-1){return this.get_container().find("> ul > li:last-child")}if(!a.length){return false}if(b){return a.prevAll("li").length>0?a.prevAll("li:eq(0)"):false}if(a.prev("li").length){a=a.prev("li").eq(0);while(a.hasClass("jstree-open")){a=a.children("ul:eq(0)").children("li:last")}return a}else{var c=a.parentsUntil(".jstree","li:eq(0)");return c.length?c:false}},_get_parent:function(a){a=this._get_node(a);if(a==-1||!a.length){return false}var b=a.parentsUntil(".jstree","li:eq(0)");return b.length?b:-1},_get_children:function(a){a=this._get_node(a);if(a===-1){return this.get_container().children("ul:eq(0)").children("li")}if(!a.length){return false}return a.children("ul:eq(0)").children("li")},get_path:function(a,b){var c=[],d=this;a=this._get_node(a);if(a===-1||!a||!a.length){return false}a.parentsUntil(".jstree","li").each(function(){c.push(b?this.id:d.get_text(this))});c.reverse();c.push(b?a.attr("id"):this.get_text(a));return c},_get_string:function(a){return this._get_settings().core.strings[a]||a},is_open:function(a){a=this._get_node(a);return a&&a!==-1&&a.hasClass("jstree-open")},is_closed:function(a){a=this._get_node(a);return a&&a!==-1&&a.hasClass("jstree-closed")},is_leaf:function(a){a=this._get_node(a);return a&&a!==-1&&a.hasClass("jstree-leaf")},correct_state:function(a){a=this._get_node(a);if(!a||a===-1){return false}a.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:a})},open_node:function(b,c,d){b=this._get_node(b);if(!b.length){return false}if(!b.hasClass("jstree-closed")){if(c){c.call()}return false}var e=d||a?0:this._get_settings().core.animation,f=this;if(!this._is_loaded(b)){b.children("a").addClass("jstree-loading");this.load_node(b,function(){f.open_node(b,c,d)},c)}else{if(this._get_settings().core.open_parents){b.parentsUntil(".jstree",".jstree-closed").each(function(){f.open_node(this,false,true)})}if(e){b.children("ul").css("display","none")}b.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading");if(e){b.children("ul").stop(true,true).slideDown(e,function(){this.style.display="";f.after_open(b)})}else{f.after_open(b)}this.__callback({obj:b});if(c){c.call()}}},after_open:function(a){this.__callback({obj:a})},close_node:function(b,c){b=this._get_node(b);var d=c||a?0:this._get_settings().core.animation,e=this;if(!b.length||!b.hasClass("jstree-open")){return false}if(d){b.children("ul").attr("style","display:block !important")}b.removeClass("jstree-open").addClass("jstree-closed");if(d){b.children("ul").stop(true,true).slideUp(d,function(){this.style.display="";e.after_close(b)})}else{e.after_close(b)}this.__callback({obj:b})},after_close:function(a){this.__callback({obj:a})},toggle_node:function(a){a=this._get_node(a);if(a.hasClass("jstree-closed")){return this.open_node(a)}if(a.hasClass("jstree-open")){return this.close_node(a)}},open_all:function(a,b,c){a=a?this._get_node(a):-1;if(!a||a===-1){a=this.get_container_ul()}if(c){a=a.find("li.jstree-closed")}else{c=a;if(a.is(".jstree-closed")){a=a.find("li.jstree-closed").andSelf()}else{a=a.find("li.jstree-closed")}}var d=this;a.each(function(){var a=this;if(!d._is_loaded(this)){d.open_node(this,function(){d.open_all(a,b,c)},!b)}else{d.open_node(this,false,!b)}});if(c.find("li.jstree-closed").length===0){this.__callback({obj:c})}},close_all:function(a,b){var c=this;a=a?this._get_node(a):this.get_container();if(!a||a===-1){a=this.get_container_ul()}a.find("li.jstree-open").andSelf().each(function(){c.close_node(this,!b)});this.__callback({obj:a})},clean_node:function(a){a=a&&a!=-1?d(a):this.get_container_ul();a=a.is("li")?a.find("li").andSelf():a.find("li");a.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed");a.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove();this.__callback({obj:a})},get_rollback:function(){this.__callback();return{i:this.get_index(),h:this.get_container().children("ul").clone(true),d:this.data}},set_rollback:function(a,b){this.get_container().empty().append(a);this.data=b;this.__callback()},load_node:function(a,b,c){this.__callback({obj:a})},_is_loaded:function(a){return true},create_node:function(a,b,c,e,f){a=this._get_node(a);b=typeof b==="undefined"?"last":b;var g=d("<li />"),h=this._get_settings().core,i;if(a!==-1&&!a.length){return false}if(!f&&!this._is_loaded(a)){this.load_node(a,function(){this.create_node(a,b,c,e,true)});return false}this.__rollback();if(typeof c==="string"){c={data:c}}if(!c){c={}}if(c.attr){g.attr(c.attr)}if(c.metadata){g.data(c.metadata)}if(c.state){g.addClass("jstree-"+c.state)}if(!c.data){c.data=this._get_string("new_node")}if(!d.isArray(c.data)){i=c.data;c.data=[];c.data.push(i)}d.each(c.data,function(a,b){i=d("<a />");if(d.isFunction(b)){b=b.call(this,c)}if(typeof b=="string"){i.attr("href","#")[h.html_titles?"html":"text"](b)}else{if(!b.attr){b.attr={}}if(!b.attr.href){b.attr.href="#"}i.attr(b.attr)[h.html_titles?"html":"text"](b.title);if(b.language){i.addClass(b.language)}}i.prepend("<ins class='jstree-icon'>&#160;</ins>");if(b.icon){if(b.icon.indexOf("/")===-1){i.children("ins").addClass(b.icon)}else{i.children("ins").css("background","url('"+b.icon+"') center center no-repeat")}}g.append(i)});g.prepend("<ins class='jstree-icon'>&#160;</ins>");if(a===-1){a=this.get_container();if(b==="before"){b="first"}if(b==="after"){b="last"}}switch(b){case"before":a.before(g);i=this._get_parent(a);break;case"after":a.after(g);i=this._get_parent(a);break;case"inside":case"first":if(!a.children("ul").length){a.append("<ul />")}a.children("ul").prepend(g);i=a;break;case"last":if(!a.children("ul").length){a.append("<ul />")}a.children("ul").append(g);i=a;break;default:if(!a.children("ul").length){a.append("<ul />")}if(!b){b=0}i=a.children("ul").children("li").eq(b);if(i.length){i.before(g)}else{a.children("ul").append(g)}i=a;break}if(i===-1||i.get(0)===this.get_container().get(0)){i=-1}this.clean_node(i);this.__callback({obj:g,parent:i});if(e){e.call(this,g)}return g},get_text:function(a){a=this._get_node(a);if(!a.length){return false}var b=this._get_settings().core.html_titles;a=a.children("a:eq(0)");if(b){a=a.clone();a.children("INS").remove();return a.html()}else{a=a.contents().filter(function(){return this.nodeType==3})[0];return a.nodeValue}},set_text:function(a,b){a=this._get_node(a);if(!a.length){return false}a=a.children("a:eq(0)");if(this._get_settings().core.html_titles){var c=a.children("INS").clone();a.html(b).prepend(c);this.__callback({obj:a,name:b});return true}else{a=a.contents().filter(function(){return this.nodeType==3})[0];this.__callback({obj:a,name:b});return a.nodeValue=b}},rename_node:function(a,b){a=this._get_node(a);this.__rollback();if(a&&a.length&&this.set_text.apply(this,Array.prototype.slice.call(arguments))){this.__callback({obj:a,name:b})}},delete_node:function(a){a=this._get_node(a);if(!a.length){return false}this.__rollback();var b=this._get_parent(a),c=d([]),e=this;a.each(function(){c=c.add(e._get_prev(this))});a=a.detach();if(b!==-1&&b.find("> ul > li").length===0){b.removeClass("jstree-open jstree-closed").addClass("jstree-leaf")}this.clean_node(b);this.__callback({obj:a,prev:c,parent:b});return a},prepare_move:function(a,b,c,e,f){var g={};g.ot=d.jstree._reference(a)||this;g.o=g.ot._get_node(a);g.r=b===-1?-1:this._get_node(b);g.p=typeof c==="undefined"||c===false?"last":c;if(!f&&h.o&&h.o[0]===g.o[0]&&h.r[0]===g.r[0]&&h.p===g.p){this.__callback(h);if(e){e.call(this,h)}return}g.ot=d.jstree._reference(g.o)||this;g.rt=d.jstree._reference(g.r)||this;if(g.r===-1||!g.r){g.cr=-1;switch(g.p){case"first":case"before":case"inside":g.cp=0;break;case"after":case"last":g.cp=g.rt.get_container().find(" > ul > li").length;break;default:g.cp=g.p;break}}else{if(!/^(before|after)$/.test(g.p)&&!this._is_loaded(g.r)){return this.load_node(g.r,function(){this.prepare_move(a,b,c,e,true)})}switch(g.p){case"before":g.cp=g.r.index();g.cr=g.rt._get_parent(g.r);break;case"after":g.cp=g.r.index()+1;g.cr=g.rt._get_parent(g.r);break;case"inside":case"first":g.cp=0;g.cr=g.r;break;case"last":g.cp=g.r.find(" > ul > li").length;g.cr=g.r;break;default:g.cp=g.p;g.cr=g.r;break}}g.np=g.cr==-1?g.rt.get_container():g.cr;g.op=g.ot._get_parent(g.o);g.cop=g.o.index();if(g.op===-1){g.op=g.ot?g.ot.get_container():this.get_container()}if(!/^(before|after)$/.test(g.p)&&g.op&&g.np&&g.op[0]===g.np[0]&&g.o.index()<g.cp){g.cp++}g.or=g.np.find(" > ul > li:nth-child("+(g.cp+1)+")");h=g;this.__callback(h);if(e){e.call(this,h)}},check_move:function(){var a=h,b=true,c=a.r===-1?this.get_container():a.r;if(!a||!a.o||a.or[0]===a.o[0]){return false}if(a.op&&a.np&&a.op[0]===a.np[0]&&a.cp-1===a.o.index()){return false}a.o.each(function(){if(c.parentsUntil(".jstree","li").andSelf().index(this)!==-1){b=false;return false}});return b},move_node:function(a,b,c,e,f,g){if(!f){return this.prepare_move(a,b,c,function(a){this.move_node(a,false,false,e,true,g)})}if(e){h.cy=true}if(!g&&!this.check_move()){return false}this.__rollback();var i=false;if(e){i=a.o.clone(true);i.find("*[id]").andSelf().each(function(){if(this.id){this.id="copy_"+this.id}})}else{i=a.o}if(a.or.length){a.or.before(i)}else{if(!a.np.children("ul").length){d("<ul />").appendTo(a.np)}a.np.children("ul:eq(0)").append(i)}try{a.ot.clean_node(a.op);a.rt.clean_node(a.np);if(!a.op.find("> ul > li").length){a.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()}}catch(j){}if(e){h.cy=true;h.oc=i}this.__callback(h);return h},_get_move:function(){return h}}})})(jQuery);(function(a){var b,c,d;a(function(){if(/msie/.test(navigator.userAgent.toLowerCase())){c=a('<textarea cols="10" rows="2"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body");d=a('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position:"absolute",top:-1e3,left:0}).appendTo("body");b=c.width()-d.width();c.add(d).remove()}else{c=a("<div />").css({width:100,height:100,overflow:"auto",position:"absolute",top:-1e3,left:0}).prependTo("body").append("<div />").find("div").css({width:"100%",height:200});b=100-c.width();c.parent().remove()}});a.jstree.plugin("ui",{__init:function(){this.data.ui.selected=a();this.data.ui.last_selected=false;this.data.ui.hovered=null;this.data.ui.to_select=this.get_settings().ui.initially_select;this.get_container().delegate("a","click.jstree",a.proxy(function(b){b.preventDefault();b.currentTarget.blur();if(!a(b.currentTarget).hasClass("jstree-loading")){this.select_node(b.currentTarget,true,b)}},this)).delegate("a","mouseenter.jstree",a.proxy(function(b){if(!a(b.currentTarget).hasClass("jstree-loading")){this.hover_node(b.target)}},this)).delegate("a","mouseleave.jstree",a.proxy(function(b){if(!a(b.currentTarget).hasClass("jstree-loading")){this.dehover_node(b.target)}},this)).bind("reopen.jstree",a.proxy(function(){this.reselect()},this)).bind("get_rollback.jstree",a.proxy(function(){this.dehover_node();this.save_selected()},this)).bind("set_rollback.jstree",a.proxy(function(){this.reselect()},this)).bind("close_node.jstree",a.proxy(function(b,c){var d=this._get_settings().ui,e=this._get_node(c.rslt.obj),f=e&&e.length?e.children("ul").find("a.jstree-clicked"):a(),g=this;if(d.selected_parent_close===false||!f.length){return}f.each(function(){g.deselect_node(this);if(d.selected_parent_close==="select_parent"){g.select_node(e)}})},this)).bind("delete_node.jstree",a.proxy(function(a,b){var c=this._get_settings().ui.select_prev_on_delete,d=this._get_node(b.rslt.obj),e=d&&d.length?d.find("a.jstree-clicked"):[],f=this;e.each(function(){f.deselect_node(this)});if(c&&e.length){b.rslt.prev.each(function(){if(this.parentNode){f.select_node(this);return false}})}},this)).bind("move_node.jstree",a.proxy(function(a,b){if(b.rslt.cy){b.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")}},this))},defaults:{select_limit:-1,select_multiple_modifier:"ctrl",select_range_modifier:"shift",selected_parent_close:"select_parent",selected_parent_open:true,select_prev_on_delete:true,disable_selecting_children:false,initially_select:[]},_fn:{_get_node:function(b,c){if(typeof b==="undefined"||b===null){return c?this.data.ui.selected:this.data.ui.last_selected}var d=a(b,this.get_container());if(d.is(".jstree")||b==-1){return-1}d=d.closest("li",this.get_container());return d.length?d:false},_ui_notify:function(a,b){if(b.selected){this.select_node(a,false)}},save_selected:function(){var a=this;this.data.ui.to_select=[];this.data.ui.selected.each(function(){if(this.id){a.data.ui.to_select.push("#"+this.id.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:"))}});this.__callback(this.data.ui.to_select)},reselect:function(){var b=this,c=this.data.ui.to_select;c=a.map(a.makeArray(c),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});a.each(c,function(a,c){if(c&&c!=="#"){b.select_node(c)}});this.data.ui.selected=this.data.ui.selected.filter(function(){return this.parentNode});this.__callback()},refresh:function(a){this.save_selected();return this.__call_old()},hover_node:function(a){a=this._get_node(a);if(!a.length){return false}if(!a.hasClass("jstree-hovered")){this.dehover_node()}this.data.ui.hovered=a.children("a").addClass("jstree-hovered").parent();this._fix_scroll(a);this.__callback({obj:a})},dehover_node:function(){var a=this.data.ui.hovered,b;if(!a||!a.length){return false}b=a.children("a").removeClass("jstree-hovered").parent();if(this.data.ui.hovered[0]===b[0]){this.data.ui.hovered=null}this.__callback({obj:a})},select_node:function(a,b,c){a=this._get_node(a);if(a==-1||!a||!a.length){return false}var d=this._get_settings().ui,e=d.select_multiple_modifier=="on"||d.select_multiple_modifier!==false&&c&&c[d.select_multiple_modifier+"Key"],f=d.select_range_modifier!==false&&c&&c[d.select_range_modifier+"Key"]&&this.data.ui.last_selected&&this.data.ui.last_selected[0]!==a[0]&&this.data.ui.last_selected.parent()[0]===a.parent()[0],g=this.is_selected(a),h=true,i=this;if(b){if(d.disable_selecting_children&&e&&(a.parentsUntil(".jstree","li").children("a.jstree-clicked").length||a.children("ul").find("a.jstree-clicked:eq(0)").length)){return false}h=false;switch(!0){case f:this.data.ui.last_selected.addClass("jstree-last-selected");a=a[a.index()<this.data.ui.last_selected.index()?"nextUntil":"prevUntil"](".jstree-last-selected").andSelf();if(d.select_limit==-1||a.length<d.select_limit){this.data.ui.last_selected.removeClass("jstree-last-selected");this.data.ui.selected.each(function(){if(this!==i.data.ui.last_selected[0]){i.deselect_node(this)}});g=false;h=true}else{h=false}break;case g&&!e:this.deselect_all();g=false;h=true;break;case!g&&!e:if(d.select_limit==-1||d.select_limit>0){this.deselect_all();h=true}break;case g&&e:this.deselect_node(a);break;case!g&&e:if(d.select_limit==-1||this.data.ui.selected.length+1<=d.select_limit){h=true}break}}if(h&&!g){if(!f){this.data.ui.last_selected=a}a.children("a").addClass("jstree-clicked");if(d.selected_parent_open){a.parents(".jstree-closed").each(function(){i.open_node(this,false,true)})}this.data.ui.selected=this.data.ui.selected.add(a);this._fix_scroll(a.eq(0));this.__callback({obj:a,e:c})}},_fix_scroll:function(a){var c=this.get_container()[0],d;if(c.scrollHeight>c.offsetHeight){a=this._get_node(a);if(!a||a===-1||!a.length||!a.is(":visible")){return}d=a.offset().top-this.get_container().offset().top;if(d<0){c.scrollTop=c.scrollTop+d-1}if(d+this.data.core.li_height+(c.scrollWidth>c.offsetWidth?b:0)>c.offsetHeight){c.scrollTop=c.scrollTop+(d-c.offsetHeight+this.data.core.li_height+1+(c.scrollWidth>c.offsetWidth?b:0))}}},deselect_node:function(a){a=this._get_node(a);if(!a.length){return false}if(this.is_selected(a)){a.children("a").removeClass("jstree-clicked");this.data.ui.selected=this.data.ui.selected.not(a);if(this.data.ui.last_selected.get(0)===a.get(0)){this.data.ui.last_selected=this.data.ui.selected.eq(0)}this.__callback({obj:a})}},toggle_select:function(a){a=this._get_node(a);if(!a.length){return false}if(this.is_selected(a)){this.deselect_node(a)}else{this.select_node(a)}},is_selected:function(a){return this.data.ui.selected.index(this._get_node(a))>=0},get_selected:function(b){return b?a(b).find("a.jstree-clicked").parent():this.data.ui.selected},deselect_all:function(b){var c=b?a(b).find("a.jstree-clicked").parent():this.get_container().find("a.jstree-clicked").parent();c.children("a.jstree-clicked").removeClass("jstree-clicked");this.data.ui.selected=a([]);this.data.ui.last_selected=false;this.__callback({obj:c})}}});a.jstree.defaults.plugins.push("ui")})(jQuery);(function(a){a.jstree.plugin("crrm",{__init:function(){this.get_container().bind("move_node.jstree",a.proxy(function(a,b){if(this._get_settings().crrm.move.open_onmove){var c=this;b.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function(){c.open_node(this,false,true)})}},this))},defaults:{input_width_limit:200,move:{always_copy:false,open_onmove:true,default_position:"last",check_move:function(a){return true}}},_fn:{_show_input:function(b,c){b=this._get_node(b);var d=this._get_settings().core.rtl,e=this._get_settings().crrm.input_width_limit,f=b.children("ins").width(),g=b.find("> a:visible > ins").width()*b.find("> a:visible > ins").length,h=this.get_text(b),i=a("<div />",{css:{position:"absolute",top:"-200px",left:d?"0px":"-1000px",visibility:"hidden"}}).appendTo("body"),j=b.css("position","relative").append(a("<input />",{value:h,"class":"jstree-rename-input",css:{padding:"0",border:"1px solid silver",position:"absolute",left:d?"auto":f+g+4+"px",right:d?f+g+4+"px":"auto",top:"0px",height:this.data.core.li_height-2+"px",lineHeight:this.data.core.li_height-2+"px",width:"150px"},blur:a.proxy(function(){var a=b.children(".jstree-rename-input"),d=a.val();if(d===""){d=h}i.remove();a.remove();this.set_text(b,h);this.rename_node(b,d);c.call(this,b,d,h);b.css("position","")},this),keyup:function(a){var b=a.keyCode||a.which;if(b==27){this.value=h;this.blur();return}else if(b==13){this.blur();return}else{j.width(Math.min(i.text("pW"+this.value).width(),e))}},keypress:function(a){var b=a.keyCode||a.which;if(b==13){return false}}})).children(".jstree-rename-input");this.set_text(b,"");i.css({fontFamily:j.css("fontFamily")||"",fontSize:j.css("fontSize")||"",fontWeight:j.css("fontWeight")||"",fontStyle:j.css("fontStyle")||"",fontStretch:j.css("fontStretch")||"",fontVariant:j.css("fontVariant")||"",letterSpacing:j.css("letterSpacing")||"",wordSpacing:j.css("wordSpacing")||""});j.width(Math.min(i.text("pW"+j[0].value).width(),e))[0].select()},rename:function(a){a=this._get_node(a);this.__rollback();var b=this.__callback;this._show_input(a,function(a,c,d){b.call(this,{obj:a,new_name:c,old_name:d})})},create:function(b,c,d,e,f){var g,h=this;b=this._get_node(b);if(!b){b=-1}this.__rollback();g=this.create_node(b,c,d,function(b){var c=this._get_parent(b),d=a(b).index();if(e){e.call(this,b)}if(c.length&&c.hasClass("jstree-closed")){this.open_node(c,false,true)}if(!f){this._show_input(b,function(a,b,e){h.__callback({obj:a,name:b,parent:c,position:d})})}else{h.__callback({obj:b,name:this.get_text(b),parent:c,position:d})}});return g},remove:function(a){a=this._get_node(a,true);var b=this._get_parent(a),c=this._get_prev(a);this.__rollback();a=this.delete_node(a);if(a!==false){this.__callback({obj:a,prev:c,parent:b})}},check_move:function(){if(!this.__call_old()){return false}var a=this._get_settings().crrm.move;if(!a.check_move.call(this,this._get_move())){return false}return true},move_node:function(a,b,c,d,e,f){var g=this._get_settings().crrm.move;if(!e){if(typeof c==="undefined"){c=g.default_position}if(c==="inside"&&!g.default_position.match(/^(before|after)$/)){c=g.default_position}return this.__call_old(true,a,b,c,d,false,f)}if(g.always_copy===true||g.always_copy==="multitree"&&a.rt.get_index()!==a.ot.get_index()){d=true}this.__call_old(true,a,b,c,d,true,f)},cut:function(a){a=this._get_node(a,true);if(!a||!a.length){return false}this.data.crrm.cp_nodes=false;this.data.crrm.ct_nodes=a;this.__callback({obj:a})},copy:function(a){a=this._get_node(a,true);if(!a||!a.length){return false}this.data.crrm.ct_nodes=false;this.data.crrm.cp_nodes=a;this.__callback({obj:a})},paste:function(a){a=this._get_node(a);if(!a||!a.length){return false}var b=this.data.crrm.ct_nodes?this.data.crrm.ct_nodes:this.data.crrm.cp_nodes;if(!this.data.crrm.ct_nodes&&!this.data.crrm.cp_nodes){return false}if(this.data.crrm.ct_nodes){this.move_node(this.data.crrm.ct_nodes,a);this.data.crrm.ct_nodes=false}if(this.data.crrm.cp_nodes){this.move_node(this.data.crrm.cp_nodes,a,false,true)}this.__callback({obj:a,nodes:b})}}})})(jQuery);(function(a){var b=[];a.jstree._themes=false;a.jstree.plugin("themes",{__init:function(){this.get_container().bind("init.jstree",a.proxy(function(){var a=this._get_settings().themes;this.data.themes.dots=a.dots;this.data.themes.icons=a.icons;this.set_theme(a.theme,a.url)},this)).bind("loaded.jstree",a.proxy(function(){if(!this.data.themes.dots){this.hide_dots()}else{this.show_dots()}if(!this.data.themes.icons){this.hide_icons()}else{this.show_icons()}},this))},defaults:{theme:"default",url:false,dots:true,icons:true},_fn:{set_theme:function(c,d){if(!c){return false}if(!d){d=a.jstree._themes+c+"/style.css"}if(a.inArray(d,b)==-1){a.vakata.css.add_sheet({url:d});b.push(d)}if(this.data.themes.theme!=c){this.get_container().removeClass("jstree-"+this.data.themes.theme);this.data.themes.theme=c}this.get_container().addClass("jstree-"+c);if(!this.data.themes.dots){this.hide_dots()}else{this.show_dots()}if(!this.data.themes.icons){this.hide_icons()}else{this.show_icons()}this.__callback()},get_theme:function(){return this.data.themes.theme},show_dots:function(){this.data.themes.dots=true;this.get_container().children("ul").removeClass("jstree-no-dots")},hide_dots:function(){this.data.themes.dots=false;this.get_container().children("ul").addClass("jstree-no-dots")},toggle_dots:function(){if(this.data.themes.dots){this.hide_dots()}else{this.show_dots()}},show_icons:function(){this.data.themes.icons=true;this.get_container().children("ul").removeClass("jstree-no-icons")},hide_icons:function(){this.data.themes.icons=false;this.get_container().children("ul").addClass("jstree-no-icons")},toggle_icons:function(){if(this.data.themes.icons){this.hide_icons()}else{this.show_icons()}}}});a(function(){if(a.jstree._themes===false){a("script").each(function(){if(this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/)){a.jstree._themes=this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/,"")+"themes/";return false}})}if(a.jstree._themes===false){a.jstree._themes="themes/"}});a.jstree.defaults.plugins.push("themes")})(jQuery);(function(a){function c(b,c){var d=a.jstree._focused(),e;if(d&&d.data&&d.data.hotkeys&&d.data.hotkeys.enabled){e=d._get_settings().hotkeys[b];if(e){return e.call(d,c)}}}var b=[];a.jstree.plugin("hotkeys",{__init:function(){if(typeof a.hotkeys==="undefined"){throw"jsTree hotkeys: jQuery hotkeys plugin not included."}if(!this.data.ui){throw"jsTree hotkeys: jsTree UI plugin not included."}a.each(this._get_settings().hotkeys,function(d,e){if(e!==false&&a.inArray(d,b)==-1){a(document).bind("keydown",d,function(a){return c(d,a)});b.push(d)}});this.get_container().bind("lock.jstree",a.proxy(function(){if(this.data.hotkeys.enabled){this.data.hotkeys.enabled=false;this.data.hotkeys.revert=true}},this)).bind("unlock.jstree",a.proxy(function(){if(this.data.hotkeys.revert){this.data.hotkeys.enabled=true}},this));this.enable_hotkeys()},defaults:{up:function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(a));return false},"ctrl+up":function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(a));return false},"shift+up":function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_prev(a));return false},down:function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(a));return false},"ctrl+down":function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(a));return false},"shift+down":function(){var a=this.data.ui.hovered||this.data.ui.last_selected||-1;this.hover_node(this._get_next(a));return false},left:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;if(a){if(a.hasClass("jstree-open")){this.close_node(a)}else{this.hover_node(this._get_prev(a))}}return false},"ctrl+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;if(a){if(a.hasClass("jstree-open")){this.close_node(a)}else{this.hover_node(this._get_prev(a))}}return false},"shift+left":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;if(a){if(a.hasClass("jstree-open")){this.close_node(a)}else{this.hover_node(this._get_prev(a))}}return false},right:function(){var a=this.data.ui.hovered||this.data.ui.last_selected;if(a&&a.length){if(a.hasClass("jstree-closed")){this.open_node(a)}else{this.hover_node(this._get_next(a))}}return false},"ctrl+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;if(a&&a.length){if(a.hasClass("jstree-closed")){this.open_node(a)}else{this.hover_node(this._get_next(a))}}return false},"shift+right":function(){var a=this.data.ui.hovered||this.data.ui.last_selected;if(a&&a.length){if(a.hasClass("jstree-closed")){this.open_node(a)}else{this.hover_node(this._get_next(a))}}return false},space:function(){if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").click()}return false},"ctrl+space":function(a){a.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(a)}return false},"shift+space":function(a){a.type="click";if(this.data.ui.hovered){this.data.ui.hovered.children("a:eq(0)").trigger(a)}return false},f2:function(){this.rename(this.data.ui.hovered||this.data.ui.last_selected)},del:function(){this.remove(this.data.ui.hovered||this._get_node(null))}},_fn:{enable_hotkeys:function(){this.data.hotkeys.enabled=true},disable_hotkeys:function(){this.data.hotkeys.enabled=false}}})})(jQuery);(function(a){a.jstree.plugin("json_data",{__init:function(){var a=this._get_settings().json_data;if(a.progressive_unload){this.get_container().bind("after_close.jstree",function(a,b){b.rslt.obj.children("ul").remove()})}},defaults:{data:false,ajax:false,correct_state:true,progressive_render:false,progressive_unload:false},_fn:{load_node:function(a,b,c){var d=this;this.load_node_json(a,function(){d.__callback({obj:d._get_node(a)});b.call(this)},c)},_is_loaded:function(b){var c=this._get_settings().json_data;b=this._get_node(b);return b==-1||!b||!c.ajax&&!c.progressive_render&&!a.isFunction(c.data)||b.is(".jstree-open, .jstree-leaf")||b.children("ul").children("li").length>0},refresh:function(b){b=this._get_node(b);var c=this._get_settings().json_data;if(b&&b!==-1&&c.progressive_unload&&(a.isFunction(c.data)||!!c.ajax)){b.removeData("jstree-children")}return this.__call_old()},load_node_json:function(b,c,d){var e=this.get_settings().json_data,f,g=function(){},h=function(){};b=this._get_node(b);if(b&&b!==-1&&(e.progressive_render||e.progressive_unload)&&!b.is(".jstree-open, .jstree-leaf")&&b.children("ul").children("li").length===0&&b.data("jstree-children")){f=this._parse_json(b.data("jstree-children"),b);if(f){b.append(f);if(!e.progressive_unload){b.removeData("jstree-children")}}this.clean_node(b);if(c){c.call(this)}return}if(b&&b!==-1){if(b.data("jstree-is-loading")){return}else{b.data("jstree-is-loading",true)}}switch(!0){case!e.data&&!e.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(e.data):e.data.call(this,b,a.proxy(function(a){a=this._parse_json(a,b);if(!a){if(b===-1||!b){if(e.correct_state){this.get_container().children("ul").empty()}}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(e.correct_state){this.correct_state(b)}}if(d){d.call(this)}}else{if(b===-1||!b){this.get_container().children("ul").empty().append(a.children())}else{b.append(a).children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading")}this.clean_node(b);if(c){c.call(this)}}},this));break;case!!e.data&&!e.ajax||!!e.data&&!!e.ajax&&(!b||b===-1):if(!b||b==-1){f=this._parse_json(e.data,b);if(f){this.get_container().children("ul").empty().append(f.children());this.clean_node()}else{if(e.correct_state){this.get_container().children("ul").empty()}}}if(c){c.call(this)}break;case!e.data&&!!e.ajax||!!e.data&&!!e.ajax&&b&&b!==-1:g=function(a,c,f){var g=this.get_settings().json_data.ajax.error;if(g){g.call(this,a,c,f)}if(b!=-1&&b.length){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(c==="success"&&e.correct_state){this.correct_state(b)}}else{if(c==="success"&&e.correct_state){this.get_container().children("ul").empty()}}if(d){d.call(this)}};h=function(d,f,h){var i=this.get_settings().json_data.ajax.success;if(i){d=i.call(this,d,f,h)||d}if(d===""||d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")===""||!a.isArray(d)&&!a.isPlainObject(d)){return g.call(this,h,f,"")}d=this._parse_json(d,b);if(d){if(b===-1||!b){this.get_container().children("ul").empty().append(d.children())}else{b.append(d).children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading")}this.clean_node(b);if(c){c.call(this)}}else{if(b===-1||!b){if(e.correct_state){this.get_container().children("ul").empty();if(c){c.call(this)}}}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(e.correct_state){this.correct_state(b);if(c){c.call(this)}}}}};e.ajax.context=this;e.ajax.error=g;e.ajax.success=h;if(!e.ajax.dataType){e.ajax.dataType="json"}if(a.isFunction(e.ajax.url)){e.ajax.url=e.ajax.url.call(this,b)}if(a.isFunction(e.ajax.data)){e.ajax.data=e.ajax.data.call(this,b)}a.ajax(e.ajax);break}},_parse_json:function(b,c,d){var e=false,f=this._get_settings(),g=f.json_data,h=f.core.html_titles,i,j,k,l,m;if(!b){return e}if(g.progressive_unload&&c&&c!==-1){c.data("jstree-children",e)}if(a.isArray(b)){e=a();if(!b.length){return false}for(j=0,k=b.length;j<k;j++){i=this._parse_json(b[j],c,true);if(i.length){e=e.add(i)}}}else{if(typeof b=="string"){b={data:b}}if(!b.data&&b.data!==""){return e}e=a("<li />");if(b.attr){e.attr(b.attr)}if(b.metadata){e.data(b.metadata)}if(b.state){e.addClass("jstree-"+b.state)}if(!a.isArray(b.data)){i=b.data;b.data=[];b.data.push(i)}a.each(b.data,function(c,d){i=a("<a />");if(a.isFunction(d)){d=d.call(this,b)}if(typeof d=="string"){i.attr("href","#")[h?"html":"text"](d)}else{if(!d.attr){d.attr={}}if(!d.attr.href){d.attr.href="#"}i.attr(d.attr)[h?"html":"text"](d.title);if(d.language){i.addClass(d.language)}}i.prepend("<ins class='jstree-icon'>&#160;</ins>");if(!d.icon&&b.icon){d.icon=b.icon}if(d.icon){if(d.icon.indexOf("/")===-1){i.children("ins").addClass(d.icon)}else{i.children("ins").css("background","url('"+d.icon+"') center center no-repeat")}}e.append(i)});e.prepend("<ins class='jstree-icon'>&#160;</ins>");if(b.children){if(g.progressive_render&&b.state!=="open"){e.addClass("jstree-closed").data("jstree-children",b.children)}else{if(g.progressive_unload){e.data("jstree-children",b.children)}if(a.isArray(b.children)&&b.children.length){i=this._parse_json(b.children,c,true);if(i.length){m=a("<ul />");m.append(i);e.append(m)}}}}}if(!d){l=a("<ul />");l.append(e);e=l}return e},get_json:function(b,c,d,e){var f=[],g=this._get_settings(),h=this,i,j,k,l,m,n;b=this._get_node(b);if(!b||b===-1){b=this.get_container().find("> ul > li")}c=a.isArray(c)?c:["id","class"];if(!e&&this.data.types){c.push(g.types.type_attr)}d=a.isArray(d)?d:[];b.each(function(){k=a(this);i={data:[]};if(c.length){i.attr={}}a.each(c,function(a,b){j=k.attr(b);if(j&&j.length&&j.replace(/jstree[^ ]*/ig,"").length){i.attr[b]=(" "+j).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}});if(k.hasClass("jstree-open")){i.state="open"}if(k.hasClass("jstree-closed")){i.state="closed"}if(k.data()){i.metadata=k.data()}l=k.children("a");l.each(function(){m=a(this);if(d.length||a.inArray("languages",g.plugins)!==-1||m.children("ins").get(0).style.backgroundImage.length||m.children("ins").get(0).className&&m.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").length){n=false;if(a.inArray("languages",g.plugins)!==-1&&a.isArray(g.languages)&&g.languages.length){a.each(g.languages,function(a,b){if(m.hasClass(b)){n=b;return false}})}j={attr:{},title:h.get_text(m,n)};a.each(d,function(a,b){j.attr[b]=(" "+(m.attr(b)||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")});if(a.inArray("languages",g.plugins)!==-1&&a.isArray(g.languages)&&g.languages.length){a.each(g.languages,function(a,b){if(m.hasClass(b)){j.language=b;return true}})}if(m.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length){j.icon=m.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,"")}if(m.children("ins").get(0).style.backgroundImage.length){j.icon=m.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","")}}else{j=h.get_text(m)}if(l.length>1){i.data.push(j)}else{i.data=j}});k=k.find("> ul > li");if(k.length){i.children=h.get_json(k,c,d,true)}f.push(i)});return f}}})})(jQuery);(function(a){a.jstree.plugin("languages",{__init:function(){this._load_css()},defaults:[],_fn:{set_lang:function(b){var c=this._get_settings().languages,d=false,e=".jstree-"+this.get_index()+" a";if(!a.isArray(c)||c.length===0){return false}if(a.inArray(b,c)==-1){if(!!c[b]){b=c[b]}else{return false}}if(b==this.data.languages.current_language){return true}d=a.vakata.css.get_css(e+"."+this.data.languages.current_language,false,this.data.languages.language_css);if(d!==false){d.style.display="none"}d=a.vakata.css.get_css(e+"."+b,false,this.data.languages.language_css);if(d!==false){d.style.display=""}this.data.languages.current_language=b;this.__callback(b);return true},get_lang:function(){return this.data.languages.current_language},_get_string:function(b,c){var d=this._get_settings().languages,e=this._get_settings().core.strings;if(a.isArray(d)&&d.length){c=c&&a.inArray(c,d)!=-1?c:this.data.languages.current_language}if(e[c]&&e[c][b]){return e[c][b]}if(e[b]){return e[b]}return b},get_text:function(b,c){b=this._get_node(b)||this.data.ui.last_selected;if(!b.size()){return false}var d=this._get_settings().languages,e=this._get_settings().core.html_titles;if(a.isArray(d)&&d.length){c=c&&a.inArray(c,d)!=-1?c:this.data.languages.current_language;b=b.children("a."+c)}else{b=b.children("a:eq(0)")}if(e){b=b.clone();b.children("INS").remove();return b.html()}else{b=b.contents().filter(function(){return this.nodeType==3})[0];return b.nodeValue}},set_text:function(b,c,d){b=this._get_node(b)||this.data.ui.last_selected;if(!b.size()){return false}var e=this._get_settings().languages,f=this._get_settings().core.html_titles,g;if(a.isArray(e)&&e.length){d=d&&a.inArray(d,e)!=-1?d:this.data.languages.current_language;b=b.children("a."+d)}else{b=b.children("a:eq(0)")}if(f){g=b.children("INS").clone();b.html(c).prepend(g);this.__callback({obj:b,name:c,lang:d});return true}else{b=b.contents().filter(function(){return this.nodeType==3})[0];this.__callback({obj:b,name:c,lang:d});return b.nodeValue=c}},_load_css:function(){var b=this._get_settings().languages,c="/* languages css */",d=".jstree-"+this.get_index()+" a",e;if(a.isArray(b)&&b.length){this.data.languages.current_language=b[0];for(e=0;e<b.length;e++){c+=d+"."+b[e]+" {";if(b[e]!=this.data.languages.current_language){c+=" display:none; "}c+=" } "}this.data.languages.language_css=a.vakata.css.add_sheet({str:c,title:"jstree-languages"})}},create_node:function(b,c,d,e){var f=this.__call_old(true,b,c,d,function(b){var c=this._get_settings().languages,d=b.children("a"),f;if(a.isArray(c)&&c.length){for(f=0;f<c.length;f++){if(!d.is("."+c[f])){b.append(d.eq(0).clone().removeClass(c.join(" ")).addClass(c[f]))}}d.not("."+c.join(", .")).remove()}if(e){e.call(this,b)}});return f}}})})(jQuery);(function(a){a.jstree.plugin("cookies",{__init:function(){if(typeof a.cookie==="undefined"){throw"jsTree cookie: jQuery cookie plugin not included."}var b=this._get_settings().cookies,c;if(!!b.save_loaded){c=a.cookie(b.save_loaded);if(c&&c.length){this.data.core.to_load=c.split(",")}}if(!!b.save_opened){c=a.cookie(b.save_opened);if(c&&c.length){this.data.core.to_open=c.split(",")}}if(!!b.save_selected){c=a.cookie(b.save_selected);if(c&&c.length&&this.data.ui){this.data.ui.to_select=c.split(",")}}this.get_container().one((this.data.ui?"reselect":"reopen")+".jstree",a.proxy(function(){this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree",a.proxy(function(a){if(this._get_settings().cookies.auto_save){this.save_cookie((a.handleObj.namespace+a.handleObj.type).replace("jstree",""))}},this))},this))},defaults:{save_loaded:"jstree_load",save_opened:"jstree_open",save_selected:"jstree_select",auto_save:true,cookie_options:{}},_fn:{save_cookie:function(b){if(this.data.core.refreshing){return}var c=this._get_settings().cookies;if(!b){if(c.save_loaded){this.save_loaded();a.cookie(c.save_loaded,this.data.core.to_load.join(","),c.cookie_options)}if(c.save_opened){this.save_opened();a.cookie(c.save_opened,this.data.core.to_open.join(","),c.cookie_options)}if(c.save_selected&&this.data.ui){this.save_selected();a.cookie(c.save_selected,this.data.ui.to_select.join(","),c.cookie_options)}return}switch(b){case"open_node":case"close_node":if(!!c.save_opened){this.save_opened();a.cookie(c.save_opened,this.data.core.to_open.join(","),c.cookie_options)}if(!!c.save_loaded){this.save_loaded();a.cookie(c.save_loaded,this.data.core.to_load.join(","),c.cookie_options)}break;case"select_node":case"deselect_node":if(!!c.save_selected&&this.data.ui){this.save_selected();a.cookie(c.save_selected,this.data.ui.to_select.join(","),c.cookie_options)}break}}}})})(jQuery);(function(a){a.jstree.plugin("sort",{__init:function(){this.get_container().bind("load_node.jstree",a.proxy(function(a,b){var c=this._get_node(b.rslt.obj);c=c===-1?this.get_container().children("ul"):c.children("ul");this.sort(c)},this)).bind("rename_node.jstree create_node.jstree create.jstree",a.proxy(function(a,b){this.sort(b.rslt.obj.parent())},this)).bind("move_node.jstree",a.proxy(function(a,b){var c=b.rslt.np==-1?this.get_container():b.rslt.np;this.sort(c.children("ul"))},this))},defaults:function(a,b){return this.get_text(a)>this.get_text(b)?1:-1},_fn:{sort:function(b){var c=this._get_settings().sort,d=this;b.append(a.makeArray(b.children("li")).sort(a.proxy(c,d)));b.find("> li > ul").each(function(){d.sort(a(this))});this.clean_node(b)}}})})(jQuery);(function(a){var b=false,c=false,d=false,e=false,f=false,g=false,h=false,i=false,j=false;a.vakata.dnd={is_down:false,is_drag:false,helper:false,scroll_spd:10,init_x:0,init_y:0,threshold:5,helper_left:5,helper_top:10,user_data:{},drag_start:function(b,c,d){if(a.vakata.dnd.is_drag){a.vakata.drag_stop({})}try{b.currentTarget.unselectable="on";b.currentTarget.onselectstart=function(){return false};if(b.currentTarget.style){b.currentTarget.style.MozUserSelect="none"}}catch(e){}a.vakata.dnd.init_x=b.pageX;a.vakata.dnd.init_y=b.pageY;a.vakata.dnd.user_data=c;a.vakata.dnd.is_down=true;a.vakata.dnd.helper=a("<div id='vakata-dragged' />").html(d);a(document).bind("mousemove",a.vakata.dnd.drag);a(document).bind("mouseup",a.vakata.dnd.drag_stop);return false},drag:function(b){if(!a.vakata.dnd.is_down){return}if(!a.vakata.dnd.is_drag){if(Math.abs(b.pageX-a.vakata.dnd.init_x)>5||Math.abs(b.pageY-a.vakata.dnd.init_y)>5){a.vakata.dnd.helper.appendTo("body");a.vakata.dnd.is_drag=true;a(document).triggerHandler("drag_start.vakata",{event:b,data:a.vakata.dnd.user_data})}else{return}}if(b.type==="mousemove"){var c=a(document),d=c.scrollTop(),e=c.scrollLeft();if(b.pageY-d<20){if(g&&h==="down"){clearInterval(g);g=false}if(!g){h="up";g=setInterval(function(){a(document).scrollTop(a(document).scrollTop()-a.vakata.dnd.scroll_spd)},150)}}else{if(g&&h==="up"){clearInterval(g);g=false}}if(a(window).height()-(b.pageY-d)<20){if(g&&h==="up"){clearInterval(g);g=false}if(!g){h="down";g=setInterval(function(){a(document).scrollTop(a(document).scrollTop()+a.vakata.dnd.scroll_spd)},150)}}else{if(g&&h==="down"){clearInterval(g);g=false}}if(b.pageX-e<20){if(f&&i==="right"){clearInterval(f);f=false}if(!f){i="left";f=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()-a.vakata.dnd.scroll_spd)},150)}}else{if(f&&i==="left"){clearInterval(f);f=false}}if(a(window).width()-(b.pageX-e)<20){if(f&&i==="left"){clearInterval(f);f=false}if(!f){i="right";f=setInterval(function(){a(document).scrollLeft(a(document).scrollLeft()+a.vakata.dnd.scroll_spd)},150)}}else{if(f&&i==="right"){clearInterval(f);f=false}}}a.vakata.dnd.helper.css({left:b.pageX+a.vakata.dnd.helper_left+"px",top:b.pageY+a.vakata.dnd.helper_top+"px"});a(document).triggerHandler("drag.vakata",{event:b,data:a.vakata.dnd.user_data})},drag_stop:function(b){if(f){clearInterval(f)}if(g){clearInterval(g)}a(document).unbind("mousemove",a.vakata.dnd.drag);a(document).unbind("mouseup",a.vakata.dnd.drag_stop);a(document).triggerHandler("drag_stop.vakata",{event:b,data:a.vakata.dnd.user_data});a.vakata.dnd.helper.remove();a.vakata.dnd.init_x=0;a.vakata.dnd.init_y=0;a.vakata.dnd.user_data={};a.vakata.dnd.is_down=false;a.vakata.dnd.is_drag=false}};a(function(){var b="#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";a.vakata.css.add_sheet({str:b,title:"vakata"})});a.jstree.plugin("dnd",{__init:function(){this.data.dnd={active:false,after:false,inside:false,before:false,off:false,prepared:false,w:0,to1:false,to2:false,cof:false,cw:false,ch:false,i1:false,i2:false,mto:false};this.get_container().bind("mouseenter.jstree",a.proxy(function(c){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){if(this.data.themes){d.attr("class","jstree-"+this.data.themes.theme);if(e){e.attr("class","jstree-"+this.data.themes.theme)}a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}if(c.currentTarget===c.target&&a.vakata.dnd.user_data.obj&&a(a.vakata.dnd.user_data.obj).length&&a(a.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==c.target){var f=a.jstree._reference(c.target),g;if(f.data.dnd.foreign){g=f._get_settings().dnd.drag_check.call(this,{o:b,r:f.get_container(),is_root:true});if(g===true||g.inside===true||g.before===true||g.after===true){a.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}}else{f.prepare_move(b,f.get_container(),"last");if(f.check_move()){a.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}}}}},this)).bind("mouseup.jstree",a.proxy(function(c){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&c.currentTarget===c.target&&a.vakata.dnd.user_data.obj&&a(a.vakata.dnd.user_data.obj).length&&a(a.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0]!==c.target){var d=a.jstree._reference(c.currentTarget),e;if(d.data.dnd.foreign){e=d._get_settings().dnd.drag_check.call(this,{o:b,r:d.get_container(),is_root:true});if(e===true||e.inside===true||e.before===true||e.after===true){d._get_settings().dnd.drag_finish.call(this,{o:b,r:d.get_container(),is_root:true})}}else{d.move_node(b,d.get_container(),"last",c[d._get_settings().dnd.copy_modifier+"Key"])}}},this)).bind("mouseleave.jstree",a.proxy(function(b){if(b.relatedTarget&&b.relatedTarget.id&&b.relatedTarget.id==="jstree-marker-line"){return false}if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if(a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}}},this)).bind("mousemove.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){var c=this.get_container()[0];if(b.pageX+24>this.data.dnd.cof.left+this.data.dnd.cw){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft+=a.vakata.dnd.scroll_spd},c),100)}else if(b.pageX-24<this.data.dnd.cof.left){if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}this.data.dnd.i1=setInterval(a.proxy(function(){this.scrollLeft-=a.vakata.dnd.scroll_spd},c),100)}else{if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}}if(b.pageY+24>this.data.dnd.cof.top+this.data.dnd.ch){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop+=a.vakata.dnd.scroll_spd},c),100)}else if(b.pageY-24<this.data.dnd.cof.top){if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.i2=setInterval(a.proxy(function(){this.scrollTop-=a.vakata.dnd.scroll_spd},c),100)}else{if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}}}},this)).bind("scroll.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree&&d&&e){d.hide();e.hide()}},this)).delegate("a","mousedown.jstree",a.proxy(function(a){if(a.which===1){this.start_drag(a.currentTarget,a);return false}},this)).delegate("a","mouseenter.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){this.dnd_enter(b.currentTarget)}},this)).delegate("a","mousemove.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){if(!c||!c.length||c.children("a")[0]!==b.currentTarget){this.dnd_enter(b.currentTarget)}if(typeof this.data.dnd.off.top==="undefined"){this.data.dnd.off=a(b.target).offset()}this.data.dnd.w=(b.pageY-(this.data.dnd.off.top||0))%this.data.core.li_height;if(this.data.dnd.w<0){this.data.dnd.w+=this.data.core.li_height}this.dnd_show()}},this)).delegate("a","mouseleave.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){if(b.relatedTarget&&b.relatedTarget.id&&b.relatedTarget.id==="jstree-marker-line"){return false}if(d){d.hide()}if(e){e.hide()}this.data.dnd.mto=setTimeout(function(a){return function(){a.dnd_leave(b)}}(this),0)}},this)).delegate("a","mouseup.jstree",a.proxy(function(b){if(a.vakata.dnd.is_drag&&a.vakata.dnd.user_data.jstree){this.dnd_finish(b)}},this));a(document).bind("drag_stop.vakata",a.proxy(function(){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if(this.data.dnd.i1){clearInterval(this.data.dnd.i1)}if(this.data.dnd.i2){clearInterval(this.data.dnd.i2)}this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;this.data.dnd.off=false;this.data.dnd.prepared=false;this.data.dnd.w=false;this.data.dnd.to1=false;this.data.dnd.to2=false;this.data.dnd.i1=false;this.data.dnd.i2=false;this.data.dnd.active=false;this.data.dnd.foreign=false;if(d){d.css({top:"-2000px"})}if(e){e.css({top:"-2000px"})}},this)).bind("drag_start.vakata",a.proxy(function(b,c){if(c.data.jstree){var d=a(c.event.target);if(d.closest(".jstree").hasClass("jstree-"+this.get_index())){this.dnd_enter(d)}}},this));var f=this._get_settings().dnd;if(f.drag_target){a(document).delegate(f.drag_target,"mousedown.jstree-"+this.get_index(),a.proxy(function(c){b=c.target;a.vakata.dnd.drag_start(c,{jstree:true,obj:c.target},"<ins class='jstree-icon'></ins>"+a(c.target).text());if(this.data.themes){if(d){d.attr("class","jstree-"+this.data.themes.theme)}if(e){e.attr("class","jstree-"+this.data.themes.theme)}a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");var f=this.get_container();this.data.dnd.cof=f.offset();this.data.dnd.cw=parseInt(f.width(),10);this.data.dnd.ch=parseInt(f.height(),10);this.data.dnd.foreign=true;c.preventDefault()},this))}if(f.drop_target){a(document).delegate(f.drop_target,"mouseenter.jstree-"+this.get_index(),a.proxy(function(c){if(this.data.dnd.active&&this._get_settings().dnd.drop_check.call(this,{o:b,r:a(c.target),e:c})){a.vakata.dnd.helper.children("ins").attr("class","jstree-ok")}},this)).delegate(f.drop_target,"mouseleave.jstree-"+this.get_index(),a.proxy(function(b){if(this.data.dnd.active){a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}},this)).delegate(f.drop_target,"mouseup.jstree-"+this.get_index(),a.proxy(function(c){if(this.data.dnd.active&&a.vakata.dnd.helper.children("ins").hasClass("jstree-ok")){this._get_settings().dnd.drop_finish.call(this,{o:b,r:a(c.target),e:c})}},this))}},defaults:{copy_modifier:"ctrl",check_timeout:100,open_timeout:500,drop_target:".jstree-drop",drop_check:function(a){return true},drop_finish:a.noop,drag_target:".jstree-draggable",drag_finish:a.noop,drag_check:function(a){return{after:false,before:false,inside:true}}},_fn:{dnd_prepare:function(){if(!c||!c.length){return}this.data.dnd.off=c.offset();if(this._get_settings().core.rtl){this.data.dnd.off.right=this.data.dnd.off.left+c.width()}if(this.data.dnd.foreign){var a=this._get_settings().dnd.drag_check.call(this,{o:b,r:c});this.data.dnd.after=a.after;this.data.dnd.before=a.before;this.data.dnd.inside=a.inside;this.data.dnd.prepared=true;return this.dnd_show()}this.prepare_move(b,c,"before");this.data.dnd.before=this.check_move();this.prepare_move(b,c,"after");this.data.dnd.after=this.check_move();if(this._is_loaded(c)){this.prepare_move(b,c,"inside");this.data.dnd.inside=this.check_move()}else{this.data.dnd.inside=false}this.data.dnd.prepared=true;return this.dnd_show()},dnd_show:function(){if(!this.data.dnd.prepared){return}var b=["before","inside","after"],c=false,f=this._get_settings().core.rtl,g;if(this.data.dnd.w<this.data.core.li_height/3){b=["before","inside","after"]}else if(this.data.dnd.w<=this.data.core.li_height*2/3){b=this.data.dnd.w<this.data.core.li_height/2?["inside","before","after"]:["inside","after","before"]}else{b=["after","inside","before"]}a.each(b,a.proxy(function(b,d){if(this.data.dnd[d]){a.vakata.dnd.helper.children("ins").attr("class","jstree-ok");c=d;return false}},this));if(c===false){a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid")}g=f?this.data.dnd.off.right-18:this.data.dnd.off.left+10;switch(c){case"before":d.css({left:g+"px",top:this.data.dnd.off.top-6+"px"}).show();if(e){e.css({left:g+8+"px",top:this.data.dnd.off.top-1+"px"}).show()}break;case"after":d.css({left:g+"px",top:this.data.dnd.off.top+this.data.core.li_height-6+"px"}).show();if(e){e.css({left:g+8+"px",top:this.data.dnd.off.top+this.data.core.li_height-1+"px"}).show()}break;case"inside":d.css({left:g+(f?-4:4)+"px",top:this.data.dnd.off.top+this.data.core.li_height/2-5+"px"}).show();if(e){e.hide()}break;default:d.hide();if(e){e.hide()}break}j=c;return c},dnd_open:function(){this.data.dnd.to2=false;this.open_node(c,a.proxy(this.dnd_prepare,this),true)},dnd_finish:function(a){if(this.data.dnd.foreign){if(this.data.dnd.after||this.data.dnd.before||this.data.dnd.inside){this._get_settings().dnd.drag_finish.call(this,{o:b,r:c,p:j})}}else{this.dnd_prepare();this.move_node(b,c,j,a[this._get_settings().dnd.copy_modifier+"Key"])}b=false;c=false;d.hide();if(e){e.hide()}},dnd_enter:function(b){if(this.data.dnd.mto){clearTimeout(this.data.dnd.mto);this.data.dnd.mto=false}var d=this._get_settings().dnd;this.data.dnd.prepared=false;c=this._get_node(b);if(d.check_timeout){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1)}this.data.dnd.to1=setTimeout(a.proxy(this.dnd_prepare,this),d.check_timeout)}else{this.dnd_prepare()}if(d.open_timeout){if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2)}if(c&&c.length&&c.hasClass("jstree-closed")){this.data.dnd.to2=setTimeout(a.proxy(this.dnd_open,this),d.open_timeout)}}else{if(c&&c.length&&c.hasClass("jstree-closed")){this.dnd_open()}}},dnd_leave:function(b){this.data.dnd.after=false;this.data.dnd.before=false;this.data.dnd.inside=false;a.vakata.dnd.helper.children("ins").attr("class","jstree-invalid");d.hide();if(e){e.hide()}if(c&&c[0]===b.target.parentNode){if(this.data.dnd.to1){clearTimeout(this.data.dnd.to1);this.data.dnd.to1=false}if(this.data.dnd.to2){clearTimeout(this.data.dnd.to2);this.data.dnd.to2=false}}},start_drag:function(c,f){b=this._get_node(c);if(this.data.ui&&this.is_selected(b)){b=this._get_node(null,true)}var g=b.length>1?this._get_string("multiple_selection"):this.get_text(b),h=this.get_container();if(!this._get_settings().core.html_titles){g=g.replace(/</ig,"<").replace(/>/ig,">")}a.vakata.dnd.drag_start(f,{jstree:true,obj:b},"<ins class='jstree-icon'></ins>"+g);if(this.data.themes){if(d){d.attr("class","jstree-"+this.data.themes.theme)}if(e){e.attr("class","jstree-"+this.data.themes.theme)}a.vakata.dnd.helper.attr("class","jstree-dnd-helper jstree-"+this.data.themes.theme)}this.data.dnd.cof=h.offset();this.data.dnd.cw=parseInt(h.width(),10);this.data.dnd.ch=parseInt(h.height(),10);this.data.dnd.active=true}}});a(function(){var b=""+"#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px; "+" -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; "+"} "+"#vakata-dragged .jstree-ok { background:green; } "+"#vakata-dragged .jstree-invalid { background:red; } "+"#jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } "+"#jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43; "+" cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666; "+" -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; "+"}"+"";a.vakata.css.add_sheet({str:b,title:"jstree"});d=a("<div />").attr({id:"jstree-marker"}).hide().html("").bind("mouseleave mouseenter",function(a){d.hide();e.hide();a.preventDefault();a.stopImmediatePropagation();return false}).appendTo("body");e=a("<div />").attr({id:"jstree-marker-line"}).hide().bind("mouseup",function(a){if(c&&c.length){c.children("a").trigger(a);a.preventDefault();a.stopImmediatePropagation();return false}}).bind("mouseleave",function(b){var f=a(b.relatedTarget);if(f.is(".jstree")||f.closest(".jstree").length===0){if(c&&c.length){c.children("a").trigger(b);d.hide();e.hide();b.preventDefault();b.stopImmediatePropagation();return false}}}).appendTo("body");a(document).bind("drag_start.vakata",function(a,b){if(b.data.jstree){d.show();if(e){e.show()}}});a(document).bind("drag_stop.vakata",function(a,b){if(b.data.jstree){d.hide();if(e){e.hide()}}})})})(jQuery);(function(a){a.jstree.plugin("checkbox",{__init:function(){this.data.checkbox.noui=this._get_settings().checkbox.override_ui;if(this.data.ui&&this.data.checkbox.noui){this.select_node=this.deselect_node=this.deselect_all=a.noop;this.get_selected=this.get_checked}this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree",a.proxy(function(a,b){this._prepare_checkboxes(b.rslt.obj)},this)).bind("loaded.jstree",a.proxy(function(a){this._prepare_checkboxes()},this)).delegate(this.data.ui&&this.data.checkbox.noui?"a":"ins.jstree-checkbox","click.jstree",a.proxy(function(a){a.preventDefault();if(this._get_node(a.target).hasClass("jstree-checked")){this.uncheck_node(a.target)}else{this.check_node(a.target)}if(this.data.ui&&this.data.checkbox.noui){this.save_selected();if(this.data.cookies){this.save_cookie("select_node")}}else{a.stopImmediatePropagation();return false}},this))},defaults:{override_ui:false,two_state:false,real_checkboxes:false,checked_parent_open:true,real_checkboxes_names:function(a){return["check_"+(a[0].id||Math.ceil(Math.random()*1e4)),1]}},__destroy:function(){this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()},_fn:{_checkbox_notify:function(a,b){if(b.checked){this.check_node(a,false)}},_prepare_checkboxes:function(b){b=!b||b==-1?this.get_container().find("> ul > li"):this._get_node(b);if(b===false){return}var c,d=this,e,f=this._get_settings().checkbox.two_state,g=this._get_settings().checkbox.real_checkboxes,h=this._get_settings().checkbox.real_checkboxes_names;b.each(function(){e=a(this);c=e.is("li")&&(e.hasClass("jstree-checked")||g&&e.children(":checked").length)?"jstree-checked":"jstree-unchecked";e.find("li").andSelf().each(function(){var b=a(this),e;b.children("a"+(d.data.languages?"":":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(f?"jstree-unchecked":c);if(g){if(!b.children(":checkbox").length){e=h.call(d,b);b.prepend("<input type='checkbox' class='jstree-real-checkbox' id='"+e[0]+"' name='"+e[0]+"' value='"+e[1]+"' />")}else{b.children(":checkbox").addClass("jstree-real-checkbox")}if(c==="jstree-checked"){b.children(":checkbox").attr("checked","checked")}}if(c==="jstree-checked"&&!f){b.find("li").addClass("jstree-checked")}})});if(!f){if(b.length===1&&b.is("li")){this._repair_state(b)}if(b.is("li")){b.each(function(){d._repair_state(this)})}else{b.find("> ul > li").each(function(){d._repair_state(this)})}b.find(".jstree-checked").parent().parent().each(function(){d._repair_state(this)})}},change_state:function(b,c){b=this._get_node(b);var d=false,e=this._get_settings().checkbox.real_checkboxes;if(!b||b===-1){return false}c=c===false||c===true?c:b.hasClass("jstree-checked");if(this._get_settings().checkbox.two_state){if(c){b.removeClass("jstree-checked").addClass("jstree-unchecked");if(e){b.children(":checkbox").removeAttr("checked")}}else{b.removeClass("jstree-unchecked").addClass("jstree-checked");if(e){b.children(":checkbox").attr("checked","checked")}}}else{if(c){d=b.find("li").andSelf();if(!d.filter(".jstree-checked, .jstree-undetermined").length){return false}d.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");if(e){d.children(":checkbox").removeAttr("checked")}}else{d=b.find("li").andSelf();if(!d.filter(".jstree-unchecked, .jstree-undetermined").length){return false}d.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(e){d.children(":checkbox").attr("checked","checked")}if(this.data.ui){this.data.ui.last_selected=b}this.data.checkbox.last_selected=b}b.parentsUntil(".jstree","li").each(function(){var b=a(this);if(c){if(b.children("ul").children("li.jstree-checked, li.jstree-undetermined").length){b.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(e){b.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked")}return false}else{b.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked");if(e){b.children(":checkbox").removeAttr("checked")}}}else{if(b.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length){b.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(e){b.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked")}return false}else{b.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked");if(e){b.children(":checkbox").attr("checked","checked")}}}})}if(this.data.ui&&this.data.checkbox.noui){this.data.ui.selected=this.get_checked()}this.__callback(b);return true},check_node:function(a){if(this.change_state(a,false)){a=this._get_node(a);if(this._get_settings().checkbox.checked_parent_open){var b=this;a.parents(".jstree-closed").each(function(){b.open_node(this,false,true)})}this.__callback({obj:a})}},uncheck_node:function(a){if(this.change_state(a,true)){this.__callback({obj:this._get_node(a)})}},check_all:function(){var a=this,b=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");b.each(function(){a.change_state(this,false)});this.__callback()},uncheck_all:function(){var a=this,b=this._get_settings().checkbox.two_state?this.get_container_ul().find("li"):this.get_container_ul().children("li");b.each(function(){a.change_state(this,true)});this.__callback()},is_checked:function(a){a=this._get_node(a);return a.length?a.is(".jstree-checked"):false},get_checked:function(a,b){a=!a||a===-1?this.get_container():this._get_node(a);return b||this._get_settings().checkbox.two_state?a.find(".jstree-checked"):a.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")},get_unchecked:function(a,b){a=!a||a===-1?this.get_container():this._get_node(a);return b||this._get_settings().checkbox.two_state?a.find(".jstree-unchecked"):a.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")},show_checkboxes:function(){this.get_container().children("ul").removeClass("jstree-no-checkboxes")},hide_checkboxes:function(){this.get_container().children("ul").addClass("jstree-no-checkboxes")},_repair_state:function(a){a=this._get_node(a);if(!a.length){return}var b=this._get_settings().checkbox.real_checkboxes,c=a.find("> ul > .jstree-checked").length,d=a.find("> ul > .jstree-undetermined").length,e=a.find("> ul > li").length;if(e===0){if(a.hasClass("jstree-undetermined")){this.change_state(a,false)}}else if(c===0&&d===0){this.change_state(a,true)}else if(c===e){this.change_state(a,false)}else{a.parentsUntil(".jstree","li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined");if(b){a.parentsUntil(".jstree","li").andSelf().children(":checkbox").removeAttr("checked")}}},reselect:function(){if(this.data.ui&&this.data.checkbox.noui){var b=this,c=this.data.ui.to_select;c=a.map(a.makeArray(c),function(a){return"#"+a.toString().replace(/^#/,"").replace(/\\\//g,"/").replace(/\//g,"\\/").replace(/\\\./g,".").replace(/\./g,"\\.").replace(/\:/g,"\\:")});this.deselect_all();a.each(c,function(a,c){b.check_node(c)});this.__callback()}else{this.__call_old()}},save_loaded:function(){var a=this;this.data.core.to_load=[];this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function(){if(this.id){a.data.core.to_load.push("#"+this.id)}})}}});a(function(){var b=".jstree .jstree-real-checkbox { display:none; } ";a.vakata.css.add_sheet({str:b,title:"jstree"})})})(jQuery);(function(a){a.vakata.xslt=function(b,c,d){var e="",f,g,h,i;if(document.recalc){f=document.createElement("xml");g=document.createElement("xml");f.innerHTML=b;g.innerHTML=c;a("body").append(f).append(g);setTimeout(function(b,c,d){return function(){d.call(null,b.transformNode(c.XMLDocument));setTimeout(function(b,c){return function(){a(b).remove();a(c).remove()}}(b,c),200)}}(f,g,d),100);return true}if(typeof window.DOMParser!=="undefined"&&typeof window.XMLHttpRequest!=="undefined"&&typeof window.XSLTProcessor==="undefined"){b=(new DOMParser).parseFromString(b,"text/xml");c=(new DOMParser).parseFromString(c,"text/xml")}if(typeof window.DOMParser!=="undefined"&&typeof window.XMLHttpRequest!=="undefined"&&typeof window.XSLTProcessor!=="undefined"){h=new XSLTProcessor;i=a.isFunction(h.transformDocument)?typeof window.XMLSerializer!=="undefined":true;if(!i){return false}b=(new DOMParser).parseFromString(b,"text/xml");c=(new DOMParser).parseFromString(c,"text/xml");if(a.isFunction(h.transformDocument)){e=document.implementation.createDocument("","",null);h.transformDocument(b,c,e,null);d.call(null,(new XMLSerializer).serializeToString(e));return true}else{h.importStylesheet(c);e=h.transformToFragment(b,document);d.call(null,a("<div />").append(e).html());return true}}return false};var b={nest:"<"+'?xml version="1.0" encoding="utf-8" ?>'+'<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >'+'<xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" />'+'<xsl:template match="/">'+'\t<xsl:call-template name="nodes">'+'\t\t<xsl:with-param name="node" select="/root" />'+"\t</xsl:call-template>"+"</xsl:template>"+'<xsl:template name="nodes">'+'\t<xsl:param name="node" />'+"\t<ul>"+'\t<xsl:for-each select="$node/item">'+'\t\t<xsl:variable name="children" select="count(./item) > 0" />'+"\t\t<li>"+'\t\t\t<xsl:attribute name="class">'+'\t\t\t\t<xsl:if test="position() = last()">jstree-last </xsl:if>'+"\t\t\t\t<xsl:choose>"+"\t\t\t\t\t<xsl:when test=\"@state = 'open'\">jstree-open </xsl:when>"+"\t\t\t\t\t<xsl:when test=\"$children or @hasChildren or @state = 'closed'\">jstree-closed </xsl:when>"+"\t\t\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>"+"\t\t\t\t</xsl:choose>"+'\t\t\t\t<xsl:value-of select="@class" />'+"\t\t\t</xsl:attribute>"+'\t\t\t<xsl:for-each select="@*">'+"\t\t\t\t<xsl:if test=\"name() != 'class' and name() != 'state' and name() != 'hasChildren'\">"+'\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+"\t\t\t\t</xsl:if>"+"\t\t\t</xsl:for-each>"+'\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>'+'\t\t\t<xsl:for-each select="content/name">'+"\t\t\t\t<a>"+'\t\t\t\t<xsl:attribute name="href">'+"\t\t\t\t\t<xsl:choose>"+'\t\t\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>'+"\t\t\t\t\t<xsl:otherwise>#</xsl:otherwise>"+"\t\t\t\t\t</xsl:choose>"+"\t\t\t\t</xsl:attribute>"+'\t\t\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>'+'\t\t\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>'+'\t\t\t\t<xsl:for-each select="@*">'+"\t\t\t\t\t<xsl:if test=\"name() != 'style' and name() != 'class' and name() != 'href'\">"+'\t\t\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+"\t\t\t\t\t</xsl:if>"+"\t\t\t\t</xsl:for-each>"+"\t\t\t\t\t<ins>"+'\t\t\t\t\t\t<xsl:attribute name="class">jstree-icon '+'\t\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>'+"\t\t\t\t\t\t</xsl:attribute>"+'\t\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>'+"\t\t\t\t\t\t<xsl:text>&#xa0;</xsl:text>"+"\t\t\t\t\t</ins>"+'\t\t\t\t\t<xsl:copy-of select="./child::node()" />'+"\t\t\t\t</a>"+"\t\t\t</xsl:for-each>"+'\t\t\t<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>'+"\t\t</li>"+"\t</xsl:for-each>"+"\t</ul>"+"</xsl:template>"+"</xsl:stylesheet>",flat:"<"+'?xml version="1.0" encoding="utf-8" ?>'+'<xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" >'+'<xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" />'+'<xsl:template match="/">'+"\t<ul>"+'\t<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">'+'\t\t<xsl:call-template name="nodes">'+'\t\t\t<xsl:with-param name="node" select="." />'+'\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />'+"\t\t</xsl:call-template>"+"\t</xsl:for-each>"+"\t</ul>"+"</xsl:template>"+'<xsl:template name="nodes">'+'\t<xsl:param name="node" />'+'\t<xsl:param name="is_last" />'+'\t<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) > 0" />'+"\t<li>"+'\t<xsl:attribute name="class">'+'\t\t<xsl:if test="$is_last = true()">jstree-last </xsl:if>'+"\t\t<xsl:choose>"+"\t\t\t<xsl:when test=\"@state = 'open'\">jstree-open </xsl:when>"+"\t\t\t<xsl:when test=\"$children or @hasChildren or @state = 'closed'\">jstree-closed </xsl:when>"+"\t\t\t<xsl:otherwise>jstree-leaf </xsl:otherwise>"+"\t\t</xsl:choose>"+'\t\t<xsl:value-of select="@class" />'+"\t</xsl:attribute>"+'\t<xsl:for-each select="@*">'+"\t\t<xsl:if test=\"name() != 'parent_id' and name() != 'hasChildren' and name() != 'class' and name() != 'state'\">"+'\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+"\t\t</xsl:if>"+"\t</xsl:for-each>"+'\t<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>'+'\t<xsl:for-each select="content/name">'+"\t\t<a>"+'\t\t<xsl:attribute name="href">'+"\t\t\t<xsl:choose>"+'\t\t\t<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>'+"\t\t\t<xsl:otherwise>#</xsl:otherwise>"+"\t\t\t</xsl:choose>"+"\t\t</xsl:attribute>"+'\t\t<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>'+'\t\t<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>'+'\t\t<xsl:for-each select="@*">'+"\t\t\t<xsl:if test=\"name() != 'style' and name() != 'class' and name() != 'href'\">"+'\t\t\t\t<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>'+"\t\t\t</xsl:if>"+"\t\t</xsl:for-each>"+"\t\t\t<ins>"+'\t\t\t\t<xsl:attribute name="class">jstree-icon '+'\t\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>'+"\t\t\t\t</xsl:attribute>"+'\t\t\t\t<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>'+"\t\t\t\t<xsl:text>&#xa0;</xsl:text>"+"\t\t\t</ins>"+'\t\t\t<xsl:copy-of select="./child::node()" />'+"\t\t</a>"+"\t</xsl:for-each>"+'\t<xsl:if test="$children">'+"\t\t<ul>"+'\t\t<xsl:for-each select="//item[@parent_id=$node/attribute::id]">'+'\t\t\t<xsl:call-template name="nodes">'+'\t\t\t\t<xsl:with-param name="node" select="." />'+'\t\t\t\t<xsl:with-param name="is_last" select="number(position() = last())" />'+"\t\t\t</xsl:call-template>"+"\t\t</xsl:for-each>"+"\t\t</ul>"+"\t</xsl:if>"+"\t</li>"+"</xsl:template>"+"</xsl:stylesheet>"},c=function(a){return a.toString().replace(/&/g,"&").replace(/</g,"<").replace(/>/g,">").replace(/"/g,""").replace(/'/g,"'")};a.jstree.plugin("xml_data",{defaults:{data:false,ajax:false,xsl:"flat",clean_node:false,correct_state:true,get_skip_empty:false,get_include_preamble:true},_fn:{load_node:function(a,b,c){var d=this;this.load_node_xml(a,function(){d.__callback({obj:d._get_node(a)});b.call(this)},c)},_is_loaded:function(b){var c=this._get_settings().xml_data;b=this._get_node(b);return b==-1||!b||!c.ajax&&!a.isFunction(c.data)||b.is(".jstree-open, .jstree-leaf")||b.children("ul").children("li").size()>0},load_node_xml:function(b,c,d){var e=this.get_settings().xml_data,f=function(){},g=function(){};b=this._get_node(b);if(b&&b!==-1){if(b.data("jstree-is-loading")){return}else{b.data("jstree-is-loading",true)}}switch(!0){case!e.data&&!e.ajax:throw"Neither data nor ajax settings supplied.";case a.isFunction(e.data):e.data.call(this,b,a.proxy(function(d){this.parse_xml(d,a.proxy(function(d){if(d){d=d.replace(/ ?xmlns="[^"]*"/ig,"");if(d.length>10){d=a(d);if(b===-1||!b){this.get_container().children("ul").empty().append(d.children())}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(d);b.removeData("jstree-is-loading")}if(e.clean_node){this.clean_node(b)}if(c){c.call(this)}}else{if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(e.correct_state){this.correct_state(b);if(c){c.call(this)}}}else{if(e.correct_state){this.get_container().children("ul").empty();if(c){c.call(this)}}}}}},this))},this));break;case!!e.data&&!e.ajax||!!e.data&&!!e.ajax&&(!b||b===-1):if(!b||b==-1){this.parse_xml(e.data,a.proxy(function(d){if(d){d=d.replace(/ ?xmlns="[^"]*"/ig,"");if(d.length>10){d=a(d);this.get_container().children("ul").empty().append(d.children());if(e.clean_node){this.clean_node(b)}if(c){c.call(this)}}}else{if(e.correct_state){this.get_container().children("ul").empty();if(c){c.call(this)}}}},this))}break;case!e.data&&!!e.ajax||!!e.data&&!!e.ajax&&b&&b!==-1:f=function(a,c,f){var g=this.get_settings().xml_data.ajax.error;if(g){g.call(this,a,c,f)}if(b!==-1&&b.length){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(c==="success"&&e.correct_state){this.correct_state(b)}}else{if(c==="success"&&e.correct_state){this.get_container().children("ul").empty()}}if(d){d.call(this)}};g=function(d,g,h){d=h.responseText;var i=this.get_settings().xml_data.ajax.success;if(i){d=i.call(this,d,g,h)||d}if(d===""||d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")===""){return f.call(this,h,g,"")}this.parse_xml(d,a.proxy(function(d){if(d){d=d.replace(/ ?xmlns="[^"]*"/ig,"");if(d.length>10){d=a(d);if(b===-1||!b){this.get_container().children("ul").empty().append(d.children())}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(d);b.removeData("jstree-is-loading")}if(e.clean_node){this.clean_node(b)}if(c){c.call(this)}}else{if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(e.correct_state){this.correct_state(b);if(c){c.call(this)}}}else{if(e.correct_state){this.get_container().children("ul").empty();if(c){c.call(this)}}}}}},this))};e.ajax.context=this;e.ajax.error=f;e.ajax.success=g;if(!e.ajax.dataType){e.ajax.dataType="xml"}if(a.isFunction(e.ajax.url)){e.ajax.url=e.ajax.url.call(this,b)}if(a.isFunction(e.ajax.data)){e.ajax.data=e.ajax.data.call(this,b)}a.ajax(e.ajax);break}},parse_xml:function(c,d){var e=this._get_settings().xml_data;a.vakata.xslt(c,b[e.xsl],d)},get_xml:function(b,d,e,f,g){var h="",i=this._get_settings(),j=this,k,l,m,n,o;if(!b){b="flat"}if(!g){g=0}d=this._get_node(d);if(!d||d===-1){d=this.get_container().find("> ul > li")}e=a.isArray(e)?e:["id","class"];if(!g&&this.data.types&&a.inArray(i.types.type_attr,e)===-1){e.push(i.types.type_attr)}f=a.isArray(f)?f:[];if(!g){if(i.xml_data.get_include_preamble){h+="<"+'?xml version="1.0" encoding="UTF-8"?'+">"}h+="<root>"}d.each(function(){h+="<item";m=a(this);a.each(e,function(a,b){var d=m.attr(b);if(!i.xml_data.get_skip_empty||typeof d!=="undefined"){h+=" "+b+'="'+c((" "+(d||"")).replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}});if(m.hasClass("jstree-open")){h+=' state="open"'}if(m.hasClass("jstree-closed")){h+=' state="closed"'}if(b==="flat"){h+=' parent_id="'+c(g)+'"'}h+=">";h+="<content>";n=m.children("a");n.each(function(){k=a(this);o=false;h+="<name";if(a.inArray("languages",i.plugins)!==-1){a.each(i.languages,function(a,b){if(k.hasClass(b)){h+=' lang="'+c(b)+'"';o=b;return false}})}if(f.length){a.each(f,function(a,b){var d=k.attr(b);if(!i.xml_data.get_skip_empty||typeof d!=="undefined"){h+=" "+b+'="'+c((" "+d||"").replace(/ jstree[^ ]*/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}})}if(k.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/^\s+$/ig,"").length){h+=' icon="'+c(k.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig,"").replace(/\s+$/ig," ").replace(/^ /,"").replace(/ $/,""))+'"'}if(k.children("ins").get(0).style.backgroundImage.length){h+=' icon="'+c(k.children("ins").get(0).style.backgroundImage.replace("url(","").replace(")","").replace(/'/ig,"").replace(/"/ig,""))+'"'}h+=">";h+="<![CDATA["+j.get_text(k,o)+"]]>";h+="</name>"});h+="</content>";l=m[0].id||true;m=m.find("> ul > li");if(m.length){l=j.get_xml(b,m,e,f,l)}else{l=""}if(b=="nest"){h+=l}h+="</item>";if(b=="flat"){h+=l}});if(!g){h+="</root>"}return h}}})})(jQuery);(function(a){a.expr[":"].jstree_contains=function(a,b,c){return(a.textContent||a.innerText||"").toLowerCase().indexOf(c[3].toLowerCase())>=0};a.expr[":"].jstree_title_contains=function(a,b,c){return(a.getAttribute("title")||"").toLowerCase().indexOf(c[3].toLowerCase())>=0};a.jstree.plugin("search",{__init:function(){this.data.search.str="";this.data.search.result=a();if(this._get_settings().search.show_only_matches){this.get_container().bind("search.jstree",function(b,c){a(this).children("ul").find("li").hide().removeClass("jstree-last");c.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function(){a(this).children("li:visible").eq(-1).addClass("jstree-last")})}).bind("clear_search.jstree",function(){a(this).children("ul").find("li").css("display","").end().end().jstree("clean_node",-1)})}},defaults:{ajax:false,search_method:"jstree_contains",show_only_matches:false},_fn:{search:function(b,c){if(a.trim(b)===""){this.clear_search();return}var d=this.get_settings().search,e=this,f=function(){},g=function(){};this.data.search.str=b;if(!c&&d.ajax!==false&&this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length>0){this.search.supress_callback=true;f=function(){};g=function(a,b,c){var d=this.get_settings().search.ajax.success;if(d){a=d.call(this,a,b,c)||a}this.data.search.to_open=a;this._search_open()};d.ajax.context=this;d.ajax.error=f;d.ajax.success=g;if(a.isFunction(d.ajax.url)){d.ajax.url=d.ajax.url.call(this,b)}if(a.isFunction(d.ajax.data)){d.ajax.data=d.ajax.data.call(this,b)}if(!d.ajax.data){d.ajax.data={search_string:b}}if(!d.ajax.dataType||/^json/.exec(d.ajax.dataType)){d.ajax.dataType="json"}a.ajax(d.ajax);return}if(this.data.search.result.length){this.clear_search()}this.data.search.result=this.get_container().find("a"+(this.data.languages?"."+this.get_lang():"")+":"+d.search_method+"("+this.data.search.str+")");this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function(){e.open_node(this,false,true)});this.__callback({nodes:this.data.search.result,str:b})},clear_search:function(b){this.data.search.result.removeClass("jstree-search");this.__callback(this.data.search.result);this.data.search.result=a()},_search_open:function(b){var c=this,d=true,e=[],f=[];if(this.data.search.to_open.length){a.each(this.data.search.to_open,function(b,c){if(c=="#"){return true}if(a(c).length&&a(c).is(".jstree-closed")){e.push(c)}else{f.push(c)}});if(e.length){this.data.search.to_open=f;a.each(e,function(a,b){c.open_node(b,function(){c._search_open(true)})});d=false}}if(d){this.search(this.data.search.str,true)}}}})})(jQuery);(function(a){a.vakata.context={hide_on_mouseleave:false,cnt:a("<div id='vakata-contextmenu' />"),vis:false,tgt:false,par:false,func:false,data:false,rtl:false,show:function(b,c,d,e,f,g,h){a.vakata.context.rtl=!!h;var i=a.vakata.context.parse(b),j,k;if(!i){return}a.vakata.context.vis=true;a.vakata.context.tgt=c;a.vakata.context.par=g||c||null;a.vakata.context.data=f||null;a.vakata.context.cnt.html(i).css({visibility:"hidden",display:"block",left:0,top:0});if(a.vakata.context.hide_on_mouseleave){a.vakata.context.cnt.one("mouseleave",function(b){a.vakata.context.hide()})}j=a.vakata.context.cnt.height();k=a.vakata.context.cnt.width();if(d+k>a(document).width()){d=a(document).width()-(k+5);a.vakata.context.cnt.find("li > ul").addClass("right")}if(e+j>a(document).height()){e=e-(j+c[0].offsetHeight);a.vakata.context.cnt.find("li > ul").addClass("bottom")}a.vakata.context.cnt.css({left:d,top:e}).find("li:has(ul)").bind("mouseenter",function(b){var c=a(document).width(),d=a(document).height(),e=a(this).children("ul").show();if(c!==a(document).width()){e.toggleClass("right")}if(d!==a(document).height()){e.toggleClass("bottom")}}).bind("mouseleave",function(b){a(this).children("ul").hide()}).end().css({visibility:"visible"}).show();a(document).triggerHandler("context_show.vakata")},hide:function(){a.vakata.context.vis=false;a.vakata.context.cnt.attr("class","").css({visibility:"hidden"});a(document).triggerHandler("context_hide.vakata")},parse:function(b,c){if(!b){return false}var d="",e=false,f=true;if(!c){a.vakata.context.func={}}d+="<ul>";a.each(b,function(b,c){if(!c){return true}a.vakata.context.func[b]=c.action;if(!f&&c.separator_before){d+="<li class='vakata-separator vakata-separator-before'></li>"}f=false;d+="<li class='"+(c._class||"")+(c._disabled?" jstree-contextmenu-disabled ":"")+"'><ins ";if(c.icon&&c.icon.indexOf("/")===-1){d+=" class='"+c.icon+"' "}if(c.icon&&c.icon.indexOf("/")!==-1){d+=" style='background:url("+c.icon+") center center no-repeat;' "}d+=">&#160;</ins><a href='#' rel='"+b+"'>";if(c.submenu){d+="<span style='float:"+(a.vakata.context.rtl?"left":"right")+";'></span>"}d+=c.label+"</a>";if(c.submenu){e=a.vakata.context.parse(c.submenu,true);if(e){d+=e}}d+="</li>";if(c.separator_after){d+="<li class='vakata-separator vakata-separator-after'></li>";f=true}});d=d.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/,"");d+="</ul>";a(document).triggerHandler("context_parse.vakata");return d.length>10?d:false},exec:function(b){if(a.isFunction(a.vakata.context.func[b])){a.vakata.context.func[b].call(a.vakata.context.data,a.vakata.context.par);return true}else{return false}}};a(function(){var b=""+"#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } "+"#vakata-contextmenu ul { min-width:180px; *width:180px; } "+"#vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } "+"#vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } "+"#vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } "+"#vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } "+"#vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } "+"#vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } "+"#vakata-contextmenu .right { right:100%; left:auto; } "+"#vakata-contextmenu .bottom { bottom:-1px; top:auto; } "+"#vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";a.vakata.css.add_sheet({str:b,title:"vakata"});a.vakata.context.cnt.delegate("a","click",function(a){a.preventDefault()}).delegate("a","mouseup",function(b){if(!a(this).parent().hasClass("jstree-contextmenu-disabled")&&a.vakata.context.exec(a(this).attr("rel"))){a.vakata.context.hide()}else{a(this).blur()}}).delegate("a","mouseover",function(){a.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")}).appendTo("body");a(document).bind("mousedown",function(b){if(a.vakata.context.vis&&!a.contains(a.vakata.context.cnt[0],b.target)){a.vakata.context.hide()}});if(typeof a.hotkeys!=="undefined"){a(document).bind("keydown","up",function(b){if(a.vakata.context.vis){var c=a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();if(!c.length){c=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()}c.addClass("vakata-hover");b.stopImmediatePropagation();b.preventDefault()}}).bind("keydown","down",function(b){if(a.vakata.context.vis){var c=a.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();if(!c.length){c=a.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()}c.addClass("vakata-hover");b.stopImmediatePropagation();b.preventDefault()}}).bind("keydown","right",function(b){if(a.vakata.context.vis){a.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover");b.stopImmediatePropagation();b.preventDefault()}}).bind("keydown","left",function(b){if(a.vakata.context.vis){a.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover");b.stopImmediatePropagation();b.preventDefault()}}).bind("keydown","esc",function(b){a.vakata.context.hide();b.preventDefault()}).bind("keydown","space",function(b){a.vakata.context.cnt.find(".vakata-hover").last().children("a").click();b.preventDefault()})}});a.jstree.plugin("contextmenu",{__init:function(){this.get_container().delegate("a","contextmenu.jstree",a.proxy(function(b){b.preventDefault();if(!a(b.currentTarget).hasClass("jstree-loading")){this.show_contextmenu(b.currentTarget,b.pageX,b.pageY)}},this)).delegate("a","click.jstree",a.proxy(function(b){if(this.data.contextmenu){a.vakata.context.hide()}},this)).bind("destroy.jstree",a.proxy(function(){if(this.data.contextmenu){a.vakata.context.hide()}},this));a(document).bind("context_hide.vakata",a.proxy(function(){this.data.contextmenu=false},this))},defaults:{select_node:false,show_at_node:true,items:{create:{separator_before:false,separator_after:true,label:"Create",action:function(a){this.create(a)}},rename:{separator_before:false,separator_after:false,label:"Rename",action:function(a){this.rename(a)}},remove:{separator_before:false,icon:false,separator_after:false,label:"Delete",action:function(a){if(this.is_selected(a)){this.remove()}else{this.remove(a)}}},ccp:{separator_before:true,icon:false,separator_after:false,label:"Edit",action:false,submenu:{cut:{separator_before:false,separator_after:false,label:"Cut",action:function(a){this.cut(a)}},copy:{separator_before:false,icon:false,separator_after:false,label:"Copy",action:function(a){this.copy(a)}},paste:{separator_before:false,icon:false,separator_after:false,label:"Paste",action:function(a){this.paste(a)}}}}}},_fn:{show_contextmenu:function(b,c,d){b=this._get_node(b);var e=this.get_settings().contextmenu,f=b.children("a:visible:eq(0)"),g=false,h=false;if(e.select_node&&this.data.ui&&!this.is_selected(b)){this.deselect_all();this.select_node(b,true)}if(e.show_at_node||typeof c==="undefined"||typeof d==="undefined"){g=f.offset();c=g.left;d=g.top+this.data.core.li_height}h=b.data("jstree")&&b.data("jstree").contextmenu?b.data("jstree").contextmenu:e.items;if(a.isFunction(h)){h=h.call(this,b)}this.data.contextmenu=true;a.vakata.context.show(h,f,c,d,this,b,this._get_settings().core.rtl);if(this.data.themes){a.vakata.context.cnt.attr("class","jstree-"+this.data.themes.theme+"-context")}}}})})(jQuery);(function(b){b.jstree.plugin("types",{__init:function(){var c=this._get_settings().types;this.data.types.attach_to=[];this.get_container().bind("init.jstree",b.proxy(function(){var a=c.types,d=c.type_attr,e="",f=this;b.each(a,function(a,c){b.each(c,function(a,b){if(!/^(max_depth|max_children|icon|valid_children)$/.test(a)){f.data.types.attach_to.push(a)}});if(!c.icon){return true}if(c.icon.image||c.icon.position){if(a=="default"){e+=".jstree-"+f.get_index()+" a > .jstree-icon { "}else{e+=".jstree-"+f.get_index()+" li["+d+'="'+a+'"] > a > .jstree-icon { '}if(c.icon.image){e+=" background-image:url("+c.icon.image+"); "}if(c.icon.position){e+=" background-position:"+c.icon.position+"; "}else{e+=" background-position:0 0; "}e+="} "}});if(e!==""){b.vakata.css.add_sheet({str:e,title:"jstree-types"})}},this)).bind("before.jstree",b.proxy(function(a,c){var d,e,f=this._get_settings().types.use_data?this._get_node(c.args[0]):false,g=f&&f!==-1&&f.length?f.data("jstree"):false;if(g&&g.types&&g.types[c.func]===false){a.stopImmediatePropagation();return false}if(b.inArray(c.func,this.data.types.attach_to)!==-1){if(!c.args[0]||!c.args[0].tagName&&!c.args[0].jquery){return}d=this._get_settings().types.types;e=this._get_type(c.args[0]);if((d[e]&&typeof d[e][c.func]!=="undefined"||d["default"]&&typeof d["default"][c.func]!=="undefined")&&this._check(c.func,c.args[0])===false){a.stopImmediatePropagation();return false}}},this));if(a){this.get_container().bind("load_node.jstree set_type.jstree",b.proxy(function(a,c){var d=c&&c.rslt&&c.rslt.obj&&c.rslt.obj!==-1?this._get_node(c.rslt.obj).parent():this.get_container_ul(),e=false,f=this._get_settings().types;b.each(f.types,function(a,b){if(b.icon&&(b.icon.image||b.icon.position)){e=a==="default"?d.find("li > a > .jstree-icon"):d.find("li["+f.type_attr+"='"+a+"'] > a > .jstree-icon");if(b.icon.image){e.css("backgroundImage","url("+b.icon.image+")")}e.css("backgroundPosition",b.icon.position||"0 0")}})},this))}},defaults:{max_children:-1,max_depth:-1,valid_children:"all",use_data:false,type_attr:"rel",types:{"default":{max_children:-1,max_depth:-1,valid_children:"all"}}},_fn:{_types_notify:function(a,b){if(b.type&&this._get_settings().types.use_data){this.set_type(b.type,a)}},_get_type:function(a){a=this._get_node(a);return!a||!a.length?false:a.attr(this._get_settings().types.type_attr)||"default"},set_type:function(a,b){b=this._get_node(b);var c=!b.length||!a?false:b.attr(this._get_settings().types.type_attr,a);if(c){this.__callback({obj:b,type:a})}return c},_check:function(a,c,d){c=this._get_node(c);var e=false,f=this._get_type(c),g=0,h=this,i=this._get_settings().types,j=false;if(c===-1){if(!!i[a]){e=i[a]}else{return}}else{if(f===false){return}j=i.use_data?c.data("jstree"):false;if(j&&j.types&&typeof j.types[a]!=="undefined"){e=j.types[a]}else if(!!i.types[f]&&typeof i.types[f][a]!=="undefined"){e=i.types[f][a]}else if(!!i.types["default"]&&typeof i.types["default"][a]!=="undefined"){e=i.types["default"][a]}}if(b.isFunction(e)){e=e.call(this,c)}if(a==="max_depth"&&c!==-1&&d!==false&&i.max_depth!==-2&&e!==0){c.children("a:eq(0)").parentsUntil(".jstree","li").each(function(b){if(i.max_depth!==-1&&i.max_depth-(b+1)<=0){e=0;return false}g=b===0?e:h._check(a,this,false);if(g!==-1&&g-(b+1)<=0){e=0;return false}if(g>=0&&(g-(b+1)<e||e<0)){e=g-(b+1)}if(i.max_depth>=0&&(i.max_depth-(b+1)<e||e<0)){e=i.max_depth-(b+1)}})}return e},check_move:function(){if(!this.__call_old()){return false}var a=this._get_move(),c=a.rt._get_settings().types,d=a.rt._check("max_children",a.cr),e=a.rt._check("max_depth",a.cr),f=a.rt._check("valid_children",a.cr),g=0,h=1,i;if(f==="none"){return false}if(b.isArray(f)&&a.ot&&a.ot._get_type){a.o.each(function(){if(b.inArray(a.ot._get_type(this),f)===-1){h=false;return false}});if(h===false){return false}}if(c.max_children!==-2&&d!==-1){g=a.cr===-1?this.get_container().find("> ul > li").not(a.o).length:a.cr.find("> ul > li").not(a.o).length;if(g+a.o.length>d){return false}}if(c.max_depth!==-2&&e!==-1){h=0;if(e===0){return false}if(typeof a.o.d==="undefined"){i=a.o;while(i.length>0){i=i.find("> ul > li");h++}a.o.d=h}if(e-a.o.d<0){return false}}return true},create_node:function(a,c,d,e,f,g){if(!g&&(f||this._is_loaded(a))){var h=typeof c=="string"&&c.match(/^before|after$/i)&&a!==-1?this._get_parent(a):this._get_node(a),i=this._get_settings().types,j=this._check("max_children",h),k=this._check("max_depth",h),l=this._check("valid_children",h),m;if(typeof d==="string"){d={data:d}}if(!d){d={}}if(l==="none"){return false}if(b.isArray(l)){if(!d.attr||!d.attr[i.type_attr]){if(!d.attr){d.attr={}}d.attr[i.type_attr]=l[0]}else{if(b.inArray(d.attr[i.type_attr],l)===-1){return false}}}if(i.max_children!==-2&&j!==-1){m=h===-1?this.get_container().find("> ul > li").length:h.find("> ul > li").length;if(m+1>j){return false}}if(i.max_depth!==-2&&k!==-1&&k-1<0){return false}}return this.__call_old(true,a,c,d,e,f,g)}}})})(jQuery);(function(a){a.jstree.plugin("html_data",{__init:function(){this.data.html_data.original_container_html=this.get_container().find(" > ul > li").clone(true);this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function(){return this.nodeType==3}).remove()},defaults:{data:false,ajax:false,correct_state:true},_fn:{load_node:function(a,b,c){var d=this;this.load_node_html(a,function(){d.__callback({obj:d._get_node(a)});b.call(this)},c)},_is_loaded:function(b){b=this._get_node(b);return b==-1||!b||!this._get_settings().html_data.ajax&&!a.isFunction(this._get_settings().html_data.data)||b.is(".jstree-open, .jstree-leaf")||b.children("ul").children("li").size()>0},load_node_html:function(b,c,d){var e,f=this.get_settings().html_data,g=function(){},h=function(){};b=this._get_node(b);if(b&&b!==-1){if(b.data("jstree-is-loading")){return}else{b.data("jstree-is-loading",true)}}switch(!0){case a.isFunction(f.data):f.data.call(this,b,a.proxy(function(d){if(d&&d!==""&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")!==""){d=a(d);if(!d.is("ul")){d=a("<ul />").append(d)}if(b==-1||!b){this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon")}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(d).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");b.removeData("jstree-is-loading")}this.clean_node(b);if(c){c.call(this)}}else{if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(f.correct_state){this.correct_state(b);if(c){c.call(this)}}}else{if(f.correct_state){this.get_container().children("ul").empty();if(c){c.call(this)}}}}},this));break;case!f.data&&!f.ajax:if(!b||b==-1){this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node()}if(c){c.call(this)}break;case!!f.data&&!f.ajax||!!f.data&&!!f.ajax&&(!b||b===-1):if(!b||b==-1){e=a(f.data);if(!e.is("ul")){e=a("<ul />").append(e)}this.get_container().children("ul").empty().append(e.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");this.clean_node()}if(c){c.call(this)}break;case!f.data&&!!f.ajax||!!f.data&&!!f.ajax&&b&&b!==-1:b=this._get_node(b);g=function(a,c,e){var g=this.get_settings().html_data.ajax.error;if(g){g.call(this,a,c,e)}if(b!=-1&&b.length){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(c==="success"&&f.correct_state){this.correct_state(b)}}else{if(c==="success"&&f.correct_state){this.get_container().children("ul").empty()}}if(d){d.call(this)}};h=function(d,e,h){var i=this.get_settings().html_data.ajax.success;if(i){d=i.call(this,d,e,h)||d}if(d===""||d&&d.toString&&d.toString().replace(/^[\s\n]+$/,"")===""){return g.call(this,h,e,"")}if(d){d=a(d);if(!d.is("ul")){d=a("<ul />").append(d)}if(b==-1||!b){this.get_container().children("ul").empty().append(d.children()).find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon")}else{b.children("a.jstree-loading").removeClass("jstree-loading");b.append(d).children("ul").find("li, a").filter(function(){return!this.firstChild||!this.firstChild.tagName||this.firstChild.tagName!=="INS"}).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon");b.removeData("jstree-is-loading")}this.clean_node(b);if(c){c.call(this)}}else{if(b&&b!==-1){b.children("a.jstree-loading").removeClass("jstree-loading");b.removeData("jstree-is-loading");if(f.correct_state){this.correct_state(b);if(c){c.call(this)}}}else{if(f.correct_state){this.get_container().children("ul").empty();if(c){c.call(this)}}}}};f.ajax.context=this;f.ajax.error=g;f.ajax.success=h;if(!f.ajax.dataType){f.ajax.dataType="html"}if(a.isFunction(f.ajax.url)){f.ajax.url=f.ajax.url.call(this,b)}if(a.isFunction(f.ajax.data)){f.ajax.data=f.ajax.data.call(this,b)}a.ajax(f.ajax);break}}}});a.jstree.defaults.plugins.push("html_data")})(jQuery);(function(a){a.jstree.plugin("themeroller",{__init:function(){var b=this._get_settings().themeroller;this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a","mouseenter.jstree",function(c){if(!a(c.currentTarget).hasClass("jstree-loading")){a(this).addClass(b.item_h)}}).delegate("a","mouseleave.jstree",function(){a(this).removeClass(b.item_h)}).bind("init.jstree",a.proxy(function(a,b){b.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh");this._themeroller(b.inst.get_container().find("> ul > li"))},this)).bind("open_node.jstree create_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.obj)},this)).bind("loaded.jstree refresh.jstree",a.proxy(function(a){this._themeroller()},this)).bind("close_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.obj)},this)).bind("delete_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.parent)},this)).bind("correct_state.jstree",a.proxy(function(a,c){c.rslt.obj.children("ins.jstree-icon").removeClass(b.opened+" "+b.closed+" ui-icon").end().find("> a > ins.ui-icon").filter(function(){return this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(b.item_open+" "+b.item_clsd).addClass(b.item_leaf||"jstree-no-icon")},this)).bind("select_node.jstree",a.proxy(function(a,c){c.rslt.obj.children("a").addClass(b.item_a)},this)).bind("deselect_node.jstree deselect_all.jstree",a.proxy(function(a,c){this.get_container().find("a."+b.item_a).removeClass(b.item_a).end().find("a.jstree-clicked").addClass(b.item_a)},this)).bind("dehover_node.jstree",a.proxy(function(a,c){c.rslt.obj.children("a").removeClass(b.item_h)},this)).bind("hover_node.jstree",a.proxy(function(a,c){this.get_container().find("a."+b.item_h).not(c.rslt.obj).removeClass(b.item_h);c.rslt.obj.children("a").addClass(b.item_h)},this)).bind("move_node.jstree",a.proxy(function(a,b){this._themeroller(b.rslt.o);this._themeroller(b.rslt.op)},this))},__destroy:function(){var b=this._get_settings().themeroller,c=["ui-icon"];a.each(b,function(a,b){b=b.split(" ");if(b.length){c=c.concat(b)}});this.get_container().removeClass("ui-widget-content").find("."+c.join(", .")).removeClass(c.join(" "))},_fn:{_themeroller:function(a){var b=this._get_settings().themeroller;a=!a||a==-1?this.get_container_ul():this._get_node(a).parent();a.find("li.jstree-closed").children("ins.jstree-icon").removeClass(b.opened).addClass("ui-icon "+b.closed).end().children("a").addClass(b.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(b.item_leaf+" "+b.item_open).addClass(b.item_clsd||"jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(b.closed).addClass("ui-icon "+b.opened).end().children("a").addClass(b.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(b.item_leaf+" "+b.item_clsd).addClass(b.item_open||"jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(b.closed+" ui-icon "+b.opened).end().children("a").addClass(b.item).children("ins.jstree-icon").addClass("ui-icon").filter(function(){return this.className.toString().replace(b.item_clsd,"").replace(b.item_open,"").replace(b.item_leaf,"").indexOf("ui-icon-")===-1}).removeClass(b.item_clsd+" "+b.item_open).addClass(b.item_leaf||"jstree-no-icon")}},defaults:{opened:"ui-icon-triangle-1-se",closed:"ui-icon-triangle-1-e",item:"ui-state-default",item_h:"ui-state-hover",item_a:"ui-state-active",item_open:"ui-icon-folder-open",item_clsd:"ui-icon-folder-collapsed",item_leaf:"ui-icon-document"}});a(function(){var b=""+".jstree-themeroller .ui-icon { overflow:visible; } "+".jstree-themeroller a { padding:0 2px; } "+".jstree-themeroller .jstree-no-icon { display:none; }";a.vakata.css.add_sheet({str:b,title:"jstree"})})})(jQuery);(function(a){a.jstree.plugin("unique",{__init:function(){this.get_container().bind("before.jstree",a.proxy(function(b,c){var d=[],e=true,f,g;if(c.func=="move_node"){if(c.args[4]===true){if(c.args[0].o&&c.args[0].o.length){c.args[0].o.children("a").each(function(){d.push(a(this).text().replace(/^\s+/g,""))});e=this._check_unique(d,c.args[0].np.find("> ul > li").not(c.args[0].o),"move_node")}}}if(c.func=="create_node"){if(c.args[4]||this._is_loaded(c.args[0])){f=this._get_node(c.args[0]);if(c.args[1]&&(c.args[1]==="before"||c.args[1]==="after")){f=this._get_parent(c.args[0]);if(!f||f===-1){f=this.get_container()}}if(typeof c.args[2]==="string"){d.push(c.args[2])}else if(!c.args[2]||!c.args[2].data){d.push(this._get_string("new_node"))}else{d.push(c.args[2].data)}e=this._check_unique(d,f.find("> ul > li"),"create_node")}}if(c.func=="rename_node"){d.push(c.args[1]);g=this._get_node(c.args[0]);f=this._get_parent(g);if(!f||f===-1){f=this.get_container()}e=this._check_unique(d,f.find("> ul > li").not(g),"rename_node")}if(!e){b.stopPropagation();return false}},this))},defaults:{error_callback:a.noop},_fn:{_check_unique:function(b,c,d){var e=[];c.children("a").each(function(){e.push(a(this).text().replace(/^\s+/g,""))});if(!e.length||!b.length){return true}e=e.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",");if(e.length+b.length!=e.concat(b).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g,"$1$2$4").replace(/,,+/g,",").replace(/,$/,"").split(",").length){this._get_settings().unique.error_callback.call(null,b,c,d);return false}return true},check_move:function(){if(!this.__call_old()){return false}var b=this._get_move(),c=[];if(b.o&&b.o.length){b.o.children("a").each(function(){c.push(a(this).text().replace(/^\s+/g,""))});return this._check_unique(c,b.np.find("> ul > li").not(b.o),"check_move")}return true}}})})(jQuery);(function(d){d.jstree.plugin("wholerow",{__init:function(){if(!this.data.ui){throw"jsTree wholerow: jsTree UI plugin not included."}this.data.wholerow.html=false;this.data.wholerow.to=false;this.get_container().bind("init.jstree",d.proxy(function(a,b){this._get_settings().core.animation=0},this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree",d.proxy(function(a,b){this._prepare_wholerow_span(b&&b.rslt&&b.rslt.obj?b.rslt.obj:-1)},this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree",d.proxy(function(a,b){if(this.data.to){clearTimeout(this.data.to)}this.data.to=setTimeout(function(a,b){return function(){a._prepare_wholerow_ul(b)}}(this,b&&b.rslt&&b.rslt.obj?b.rslt.obj:-1),0)},this)).bind("deselect_all.jstree",d.proxy(function(a,b){this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked "+(this.data.themeroller?this._get_settings().themeroller.item_a:""))},this)).bind("select_node.jstree deselect_node.jstree ",d.proxy(function(a,b){b.rslt.obj.each(function(){var a=b.inst.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((d(this).offset().top-b.inst.get_container().offset().top+b.inst.get_container()[0].scrollTop)/b.inst.data.core.li_height,10)+")");a.children("a").attr("class",b.rslt.obj.children("a").attr("class"))})},this)).bind("hover_node.jstree dehover_node.jstree",d.proxy(function(a,b){this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered "+(this.data.themeroller?this._get_settings().themeroller.item_h:""));if(a.type==="hover_node"){var c=this.get_container().find(" > .jstree-wholerow li:visible:eq("+parseInt((b.rslt.obj.offset().top-this.get_container().offset().top+this.get_container()[0].scrollTop)/this.data.core.li_height,10)+")");c.children("a").attr("class",b.rslt.obj.children(".jstree-hovered").attr("class"))}},this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li","click.jstree",function(a){var b=d(a.currentTarget);if(a.target.tagName==="A"||a.target.tagName==="INS"&&b.closest("li").is(".jstree-open, .jstree-closed")){return}b.closest("li").children("a:visible:eq(0)").click();a.stopImmediatePropagation()}).delegate("li","mouseover.jstree",d.proxy(function(a){a.stopImmediatePropagation();if(d(a.currentTarget).children(".jstree-hovered, .jstree-clicked").length){return false}this.hover_node(a.currentTarget);return false},this)).delegate("li","mouseleave.jstree",d.proxy(function(a){if(d(a.currentTarget).children("a").hasClass("jstree-hovered").length){return}this.dehover_node(a.currentTarget)},this));if(b||a){d.vakata.css.add_sheet({str:".jstree-"+this.get_index()+" { position:relative; } ",title:"jstree"})}},defaults:{},__destroy:function(){this.get_container().children(".jstree-wholerow").remove();this.get_container().find(".jstree-wholerow-span").remove()},_fn:{_prepare_wholerow_span:function(a){a=!a||a==-1?this.get_container().find("> ul > li"):this._get_node(a);if(a===false){return}a.each(function(){d(this).find("li").andSelf().each(function(){var a=d(this);if(a.children(".jstree-wholerow-span").length){return true}a.prepend("<span class='jstree-wholerow-span' style='width:"+a.parentsUntil(".jstree","li").length*18+"px;'>&#160;</span>")})})},_prepare_wholerow_ul:function(){var a=this.get_container().children("ul").eq(0),c=a.html();a.addClass("jstree-wholerow-real");if(this.data.wholerow.last_html!==c){this.data.wholerow.last_html=c;this.get_container().children(".jstree-wholerow").remove();this.get_container().append(a.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(a.parent()[0].scrollWidth).css("top",(a.height()+(b?5:0))*-1).find("li[id]").each(function(){this.removeAttribute("id")}).end())}}}});d(function(){var e=""+".jstree .jstree-wholerow-real { position:relative; z-index:1; } "+".jstree .jstree-wholerow-real li { cursor:pointer; } "+".jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } "+".jstree .jstree-wholerow { position:relative; z-index:0; height:0; } "+".jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } "+".jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } "+".jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }"+".jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }"+".jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } "+".jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";if(c){e+=""+".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } "+".jstree .jstree-wholerow-real a { border-color:transparent !important; } "}if(b||a){e+=""+".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } "+".jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } "}d.vakata.css.add_sheet({str:e,title:"jstree"})})})(jQuery);(function(a){var b=["getChildren","getChildrenCount","getAttr","getName","getProps"],c=function(b,c){var d=true;b=b||{};c=[].concat(c);a.each(c,function(c,e){if(!a.isFunction(b[e])){d=false;return false}});return d};a.jstree.plugin("model",{__init:function(){if(!this.data.json_data){throw"jsTree model: jsTree json_data plugin not included."}this._get_settings().json_data.data=function(d,e){var f=d==-1?this._get_settings().model.object:d.data("jstree_model");if(!c(f,b)){return e.call(null,false)}if(this._get_settings().model.async){f.getChildren(a.proxy(function(a){this.model_done(a,e)},this))}else{this.model_done(f.getChildren(),e)}}},defaults:{object:false,id_prefix:false,async:false},_fn:{model_done:function(b,c){var d=[],e=this._get_settings(),f=this;if(!a.isArray(b)){b=[b]}a.each(b,function(b,c){var g=c.getProps()||{};g.attr=c.getAttr()||{};if(c.getChildrenCount()){g.state="closed"}g.data=c.getName();if(!a.isArray(g.data)){g.data=[g.data]}if(f.data.types&&a.isFunction(c.getType)){g.attr[e.types.type_attr]=c.getType()}if(g.attr.id&&e.model.id_prefix){g.attr.id=e.model.id_prefix+g.attr.id}if(!g.metadata){g.metadata={}}g.metadata.jstree_model=c;d.push(g)});c.call(null,d)}}});})(jQuery);})();