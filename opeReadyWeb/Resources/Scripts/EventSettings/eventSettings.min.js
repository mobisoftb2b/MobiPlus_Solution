function deleteSpecFormatter(a, b, c) { var d; try { d = new Image(32, 32); if (!c.isBusy) { $(d).attr("src", "/opeReady/Resources/icons/trash.png"); $(d).attr("style", "cursor:pointer") } else { $(d).attr("src", "/opeReady/Resources/images/empty.png") } } catch (e) { } return d.outerHTML || (new XMLSerializer).serializeToString(d) } var rowCount; var eventSetting = {}; eventSetting.CreateEventSettingsGrid = function (a) { var b; if ($.cookie("lang")) { if ($.cookie("lang") == "he-IL" || $.cookie("lang") == "ar") b = "rtl"; else b = "ltr" } $("#divDefineEventSettings").block({ css: { border: "0px" }, overlayCSS: { backgroundColor: "#ffffff", opacity: .7 }, message: "" }); $("#tblEventTypeSettings").jqGrid({ direction: b, datatype: function (a) { eventSetting.getEventSettingData() }, height: 375, colNames: [$("#hidEventSettings_Grid_EventType").text(), $("#hidEventSettings_Grid_ExecutionLebel").text(), $("#hidEventSettings_Grid_Score").text(), $("#hidEventSettings_Grid_Quantity").text(), "", "", "TrainingEventType_ID", "", "", "", "", "", ""], colModel: [{ name: "TrainingEventType_Name", index: "TrainingEventType_Name", sortable: true, sorttype: "text", width: 250 }, { name: "isExecutionLevelRequiredField", index: "isExecutionLevelRequiredField", align: "center", formatter: checkboxPic, sortable: false, width: 130 }, { name: "isScoreRequiredField", index: "isScoreRequiredField", sortable: false, formatter: checkboxPic, align: "center", width: 100 }, { name: "isQuantityRequiredField", index: "isQuantityRequiredField", sortable: false, align: "center", formatter: checkboxPic, width: 100 }, { name: "EditType", index: "EditType", sortable: false, edittype: "image", formatter: editFormatter, width: 35, align: "center" }, { name: "DelType", index: "DelType", sortable: false, edittype: "image", formatter: deleteSpecFormatter, width: 45, align: "center" }, { name: "TrainingEventType_ID", hidden: "true" }, { name: "isExecutionLevelRequiredField", hidden: "true" }, { name: "isQuantityRequiredField", hidden: "true" }, { name: "isScoreRequiredField", hidden: "true" }, { name: "RecoverFromFailureInDays", hidden: "true" }, { name: "isBusy", hidden: "true" }, { name: "BestPerformance", hidden: "true"}], viewrecords: true, sortorder: "asc", autoencode: false, loadonce: false, pginput: true, altRows: true, hoverrows: false, toolbar: [true, "top"], recordpos: b == "rtl" ? "left" : "right", pager: "#pgrEventTypeSettings", pgbuttons: false, pginput: false, gridComplete: function () { $(this).setGridParam({ datatype: "local", selarrrow: "false" }); if (rowCount == $(this).getGridParam("records")) { $("#waitplease").css({ display: "none" }); $("#divDefineEventSettings").unblock() } }, onCellSelect: function (a, b, c, d) { switch (b) { case 4: eventSetting.DefineEventTypeSetting_Open($(this).getRowData(a)); break; case 5: if ($(this).getRowData(a).isBusy == "false") return eventSetting.DefineEventTypeSetting_Delete($(this).getRowData(a).TrainingEventType_ID); break } return false }, ondblClickRow: function (a, b, c, d) { eventSetting.DefineEventTypeSetting_Open($(this).getRowData(a)) } }); $("#tblEventTypeSettings").jqGrid("gridResize", { minWidth: 750, minHeight: 300 }).toolbarButtonAdd("#t_tblEventTypeSettings", { caption: $("#hidEventSettings_btnAddEventType").text(), position: "first", align: b == "rtl" ? "right" : "left", buttonicon: "ui-icon-circle-plus", onClickButton: function () { eventSetting.DefineEventSettingData_New() } }) }; eventSetting.getEventSettingData = function () { PQ.Admin.WebService.EventTypeSettingsService.EventTypeSettings_SelectAll(function (a, b) { eventSetting.ReceivedEventTypeSettingData(JSON.parse(getMain(a)).rows) }, function (a, b) { return false }) }; eventSetting.ReceivedEventTypeSettingData = function (a) { var b = $("#tblEventTypeSettings"); b.clearGridData(); rowCount = a.length; if (!rowCount) $("#divDefineEventSettings").unblock(); for (var c = 0; c < a.length; c++) b.addRowData(c + 1, a[c]) }; eventSetting.DefineEventSettingData_New = function () { $("#txtEventType").val(""); $("#rdScore").attr("checked", false); $("#rdQuantity").attr("checked", false); $("#rdExecutionLevel").attr("checked", false); $("#txtFailureRecovery").val(""); $("#hidTrainingEventType_ID").val(""); $("#btnAddNewEventType").val($("#lblEventSubject_btnAddNewEventSubjects").text()); divDefineEventSettingsDetails_Open() }; eventSetting.DefineEventTypeSetting_Open = function (a) { if (a) { $("#btnAddNewEventType").val($("#lblEventSettings_btnUpdate").text()); $("#txtEventType").val(a.TrainingEventType_Name); $("#rdScore").attr("checked", a.isScoreRequiredField === "true" ? true : false); $("#rdQuantity").attr("checked", a.isQuantityRequiredField === "true" ? true : false); $("#rdExecutionLevel").attr("checked", a.isExecutionLevelRequiredField === "true" ? true : false); $("#txtFailureRecovery").val(a.RecoverFromFailureInDays); $("#hidTrainingEventType_ID").val(a.TrainingEventType_ID); $("#rdoHightLevel").attr("checked", a.BestPerformance === "true" ? true : a.BestPerformance === "" ? true : false); $("#rdoLowLevel").attr("checked", a.BestPerformance === "false" ? true : false) } divDefineEventSettingsDetails_Open() }; eventSetting.SaveEventTypeSettingData = function (a) { if (a) { PQ.Admin.WebService.EventTypeSettingsService.EventTypeSettings_Save(a, function (a) { if (a) { $("#tblEventTypeSettings").GridUnload(); eventSetting.CreateEventSettingsGrid(null); $("#divDefineEventSettingsDetails").dialog("destroy") } $("#waitplease").css({ display: "none" }) }, function (a) { $("#waitplease").css({ display: "none" }) }) } }; eventSetting.DefineEventTypeSetting_Delete = function (a) { if (a) { $("#ConfirmDeleteAttachment").dialog({ autoOpen: true, modal: true, resizable: false, closeOnEscape: true, height: 150, open: function (a, b) { $(this).parent().appendTo("form") }, buttons: { Ok: function (b) { b.preventDefault(); $("#waitplease").css({ display: "block" }); try { PQ.Admin.WebService.EventTypeSettingsService.EventTypeSettings_Delete(a, function (a) { if (a) { $("#tblEventTypeSettings").GridUnload(); eventSetting.CreateEventSettingsGrid(null) } else { RaiseWarningAlert($("#hidEventSettings_DeleteEventSubjectError").text()) } $("#waitplease").css({ display: "none" }); $("#ConfirmDeleteAttachment").dialog("destroy") }, function (a) { $("#waitplease").css({ display: "none" }); $("#ConfirmDeleteAttachment").dialog("destroy"); return false }) } catch (b) { return false } return false }, Cancel: function (a) { a.preventDefault(); $(this).dialog("destroy"); return false } } }); return false } };eventSetting.DefineEventTypeSettingRequaredFields = function () { var a = new Boolean(true); var b = $("input:radio:checked").val(); if ($("#txtEventType").val() == "") { $("#txtEventType").addClass("ui-state-error").focus(); return false } else { $("#txtEventType").removeClass("ui-state-error", 500); a = true } return a };