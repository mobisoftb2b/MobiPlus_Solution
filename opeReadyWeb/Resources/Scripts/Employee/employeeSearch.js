function backgroundFormatter(e, t, n) { var r = new Image(40, 50); $(r).attr("id", n.Person_ID); $(r).attr("src", "/opeReady/Handlers/readinessPictures.ashx?rdnsid=" + n.ReadinessLevel_ID); return r.outerHTML || (new XMLSerializer).serializeToString(r) } function imageFormatter(e, t, n) { var r = new Image(40, 50); $(r).attr("id", n.Person_ID); $(r).attr("src", "/opeReady/Handlers/PhotoHandler.ashx?eid=" + n.Person_ID); $(r).attr("class", "tooltip"); return r.outerHTML || (new XMLSerializer).serializeToString(r) } var rowCount; var icons = { header: "ui-icon-circle-arrow-e", headerSelected: "ui-icon-circle-arrow-s" }; var employeeSearch = {}; employeeSearch.Init = function () { }; employeeSearch.CreateEmployeeCollectionGrid = function (e) {
    var t; if ($.cookie("lang")) { if ($.cookie("lang") == "he-IL" || $.cookie("lang") == "ar") t = "rtl"; else t = "ltr" } $("#divResultPanel").block({ css: { border: "0px" }, overlayCSS: { backgroundColor: "#ffffff", opacity: .7 }, message: "" }); $("#tblEmlpoyee").jqGrid({ direction: t, datatype: function (t) { employeeSearch.getEmployeeSearchData(e) }, height: 400, autowidth: true, gridview: true, loadonce: false, colNames: [$("#hidEmpSearch_Grid_headerPhoto").text(), $("#hidEmpSearch_Grid_lblEmployeeID").text(), $("#hidEmpSearch_Grid_lblFirstName").text(), $("#hidEmpSearch_Grid_lblLastName").text(), $("#hidEmpSearch_Grid_lblJob").text(), $("#hidEmpSearch_Grid_lblUnit").text(), "", $("#hidEmpSearch_Grid_header_ReadinessLevel").text(), $("#hidEmpSearch_btnEdit").text(), "ReadinessLevel_ID"], colModel: [{ name: "Photo", index: "Photo", formatter: imageFormatter, width: 35, align: "center", classes: "personPopup", sortable: false }, { name: "Person_ID", index: "Person_ID", sortable: true, key: true, sorttype: "number", width: 125 }, { name: "Person_FirstName", index: "Person_FirstName", sortable: true, sorttype: "text", width: 125 }, { name: "Person_LastName", index: "Person_LastName", sortable: true, sorttype: "text", width: 125 }, { name: "Job_Name", index: "Job_Name", sortable: true, sorttype: "text", width: 125 }, { name: "Unit_Name", index: "Unit_Name", sortable: true, sorttype: "text", width: 125 }, { name: "LabelEmployee", index: "LabelEmployee", sortable: false, formatter: backgroundFormatter, width: 35, align: "center" }, { name: "ReadinessLevel_Name", index: "ReadinessLevel_Name", sortable: true, align: "center", width: 80 }, { name: "EditEmployee", index: "EditEmployee", sortable: false, edittype: "image", formatter: editFormatter, width: 25, align: "center" }, { name: "ReadinessLevel_ID", hidden: "true"}], imgpath: '<%= ResolveClientUrl("~/Resources/Styles/redmon/images") %>', viewrecords: true, autoencode: false, altRows: false, hoverrows: false, pager: "#pgrEmlpoyee", rowNum: 20000,
        recordpos: "left", pgbuttons: false, pginput: false, sortorder: "desc", toolbar: [true, "top"], gridComplete: function () { $(this).setGridParam({ datatype: "local", selarrrow: "false" }); if (rowCount == $(this).getGridParam("records")) { employeeSearch.imagePreview(); $("#divResultPanel").unblock(); $("#waitplease").css({ display: "none" }) } }, onCellSelect: function (e, t, n, r) { switch (t) { case 8: employeeSearch.LoadSelectedEmployee($(this).getRowData(e).Person_ID); break } return false }, ondblClickRow: function (e, t, n, r) { employeeSearch.LoadSelectedEmployee($(this).getRowData(e).Person_ID) }
    }); $("#tblEmlpoyee").jqGrid("gridResize", { minWidth: 674, minHeight: 300 }).toolbarButtonAdd("#t_tblEmlpoyee", { caption: "Excel", position: "last", align: t == "rtl" ? "right" : "left", buttonicon: "ui-icon-contact", onClickButton: function () { if (rowCount == 0) return false; var e = "/opeReady/Handlers/ExcelExport/EmployeeExcel.ashx"; var t = "?pid=" + $("#txtEmployeeID").val() + "&pcid=" + $("#cboClassification").val() + "&rid=" + $("#ddlReadinessLabel").val() + "&pfn=" + $("#txtFirstName").val(); t += "&pln=" + $("#txtLastName").val() + "&jid=" + $("#cboJob").val() + "&uid=" + $("#hidUnitID").val() + "&ia=" + $("#chkActiveEmployee").attr("checked") + "&ir=" + $("#chkIsReadiness").attr("checked"); $("#tblEmlpoyee").jqGrid("excelExport", { url: e + t }) } })
}; employeeSearch.ShowIconParamsArea = function () { var e = $("#divSerchPanel"); var t = $("#imgShowParams"); if (e.is(":visible")) { e.toggle(function () { t.fadeIn("slow") }) } else { e.toggle(function () { t.fadeOut("slow") }) } }; employeeSearch.imagePreview = function () { xOffset = 200; yOffset = 30; $(".tooltip").hover(function (e) { this.t = this.title; this.title = ""; var t = this.t != "" ? "<br/>" + this.t : ""; $("body").append("<p id='preview'><img src='" + this.src + "' width='145px' />" + t + "</p>"); $("#preview").css("top", e.pageY - xOffset + "px").css("left", e.pageX + yOffset + "px").fadeIn("fast") }, function () { this.title = this.t; $("#preview").remove() }); $(".tooltip").mousemove(function (e) { $("#preview").css("top", e.pageY - xOffset + "px").css("left", e.pageX + yOffset + "px") }) }; employeeSearch.getEmployeeSearchData = function (e) { var t = { Person_ID: $("#txtEmployeeID").val(), PersonCategory_ID: $("#cboClassification").val(), ReadinessLevel_ID: $("#ddlReadinessLabel").val(), Person_FirstName: $("#txtFirstName").val(), Person_LastName: $("#txtLastName").val(), Job_ID: $("#cboJob").val(), UnitID: $("#hidUnitID").val(), IsActive: $("#chkActiveEmployee").attr("checked"), IsReadiness: $("#chkIsReadiness").attr("checked"), QtyPerson: isNaN(e) ? null : e }; PQ.Admin.WebService.EmployeeSearchWS.EmployeeSearch(t, function (e, t) { employeeSearch.ReceivedEmployeeSearchData(JSON.parse(getMain(e)).rows) }, function (e, t) { return false }) }; employeeSearch.ReceivedEmployeeSearchData = function (e) { var t = $("#tblEmlpoyee"); t.clearGridData(); rowCount = e.length; for (var n = 0; n < e.length; n++) t.addRowData(n + 1, e[n]); $("#waitplease").css({ display: "none" }); $("#divResultPanel").unblock() }; employeeSearch.getMain = function (e) { if (e.hasOwnProperty("d")) return e.d; else return e }; employeeSearch.LoadSelectedEmployee = function (e) { if (e) { employeePages.getEmplDataForUpdate(e) } };