function applicationLoadHandler() { employeePages.Init() } function endRequestHandler(e, t) { if (t.get_error()) { t.set_errorHandled(true) } try { $("#gvEmlpoyee tr:even td").addClass("reg alt").hover(function () { $(this).addClass("") }, function () { }); $("#divAdminTasksEdit").dialog("destroy"); $("#waitplease").css({ display: "none" }); $(".image").hover(function () { $(this).css({ cursor: "pointer" }) }, function () { $(this).css({ cursor: "default" }) }) } catch (n) { $("#waitplease").css({ display: "none" }); return false } } function beginRequestHandler() { $("#waitplease").css({ display: "block" }) } var employeePages = { availableTags: null, rowObject: null, pathSrc: null, employeeDetailsPath: null, employeeListPage: null }; employeePages.Init = function () { employeePages.SetFirstNameArray(); employeePages.SetLastNameArray(); employeePages.SetMiddleNameArray() }; employeePages.CreateUnitTree = function (e) { try { PQ.Admin.WebService.PQWebService.GetUserMenu(e, this.ExecuteUnitTreeCallbackResult, this.ExecuteFailResult) } catch (t) { alert(t.Description) } }; employeePages.ExecuteUnitTreeCallbackResult = function (e) { if (e) { var t, n; if ($.cookie("lang")) { var r = $.cookie("lang"); if (r == "he-IL" || r == "ar") { t = "default-rtl"; n = true } else { t = "default"; n = false } } try { var i = $("#lblTreeLebel").text() == "" ? 0 : parseInt($("#lblTreeLebel").text()); var s = GetArrayTreeIDs(e, i); $("#treeUnits").jstree({ xml_data: { data: e }, plugins: ["themes", "xml_data", "ui", "types"], core: { rtl: n, initially_open: [s], animation: "100" }, themes: { theme: t }, types: { types: { file: { valid_children: ["default"], icon: { image: "/opeReady/Resources/images/active.png"} }, folder: { valid_children: "all", icon: { image: "/opeReady/Resources/images/close.png" }, hover_node: false, select_node: function () { return false } }}} }).bind("select_node.jstree", function (e, t) { $("#hidUnitID").val(t.rslt.obj.get(0).id); $("#ddlUnit").val($(t.rslt.obj.find("a").get(0)).text()); $("#treeUnits").fadeOut("slow"); $("#ddlUnit").removeClass("ui-state-error", 100); return false }) } catch (o) { } } }; employeePages.getEmplDataForUpdate = function (e) { if (e) { $("#waitplease").css({ display: "block" }); window.location.href = "EmployeeDetails.aspx?eid=" + e } }; employeePages.SetMiddleNameArray = function (e) { try { $("#txtMiddleName").autocomplete({ source: function (e, t) { PQ.Admin.WebService.PQWebService.GetMiddleNameCompletionList(e.term, function (e) { if (e) { t($.map(getMain(e), function (e) { return { value: e.Person_MiddleName} })) } }, function (e) { }, null) }, minLength: 1 }) } catch (t) { return false } }; employeePages.SetFirstNameArray = function () { try { $("#txtFirstName").autocomplete({ source: function (e, t) { PQ.Admin.WebService.PQWebService.GetFirstNameCompletionList(e.term, function (e) { if (e) { t($.map(getMain(e), function (e) { return { value: e.Person_FirstName} })) } }, function (e) { }, null) }, minLength: 1 }) } catch (e) { return false } }; employeePages.SetLastNameArray = function (e) { try { $("#txtLastName").autocomplete({ source: function (e, t) { PQ.Admin.WebService.PQWebService.GetLastNameCompletionList(e.term, function (e) { if (e) { t($.map(getMain(e), function (e) { return { value: e.Person_LastName} })) } }, function (e) { }, null) }, minLength: 1 }) } catch (t) { return false } }; employeePages.Create_tab = function (e, t, n) { var r = t; var i = n; var s = 200; var o = getArgs(); if ($.browser.msie) { s = 10 } disable = false; $(r).each(function (t) { if (t == 0) { $(e).prepend("<div class='jquery_tab_container'><a href='/' class='heading_tab advanced_link active tab" + (t + 1) + "'>" + $(this).html() + "</a></div>") } else if (o.eid == undefined) { return false } else { $(".advanced_link:last").after("<a href='/'class='heading_tab advanced_link tab" + (t + 1) + "'>" + $(this).html() + "</a>") } }); $(i).each(function (e) { $(this).addClass("tablist list_" + e); if (e != 0) { $(this).css({ display: "none" }) } }); $(".advanced_link").each(function (e) { $(this).bind("click", function () { if ($(this).hasClass("active")) { return false } if (disable == false) { disable = true; $(".advanced_link").removeClass("active"); $(this).addClass("active"); employeePages.TabPopulateSelector($(this).find("span")[0].id); $(i + ":visible").fadeOut(s, function () { $(".list_" + e).fadeIn(s, function () { disable = false }) }) } return false }) }) }; employeePages.Choosetab = function () { var e = window.location.hash; try { if (e.match(/^#tab(\d)$/)) { var t = e.replace(/^#tab/, ""); var n = t - 1; $(".jquery_tab").css({ display: "none" }).filter(":eq(" + n + ")").css({ display: "block" }); $(".jquery_tab_container .active").removeClass("active"); $(".heading_tab").filter(":eq(" + n + ")").addClass("active") } } catch (r) { return false } }; employeePages.LoadEmployeeDetailsGeneral = function () { $("#waitplease").css({ display: "block" }); $("#loader").empty().addClass("loading"); var e = new Date; var t = new Image(145, 167); var n = getArgs(); if (n.eid) { PQ.Admin.WebService.PQWebService.Person_SelectByID(n.eid, function (e) { $("#txtEmployeeID").val(e.Person_ID.toString()); $("#txtFirstNameDetails").val(e.Person_FirstName); $("#txtLastNameDetails").val(e.Person_LastName); $("#txtMiddleNameDetails").val(e.Person_MiddleName); $("#ddlClassification").val(e.PersonCategory_ID); $("#txtOrganizationID").val(e.Person_OrganizationID); $("#txtBirthDay").val(e.PersonBirthDateStr); $("#txtPhone").val(e.Person_Tel1); $("#txtCellular").val(e.Person_Tel2); $("#txtFax").val(e.Person_Tel3); $("#txtCity").val(e.Person_Address1); $("#txtStreet").val(e.Person_Address2); $("#txtApartment").val(e.Person_Address3); $("#txtEmail").val(e.Person_Email); $("#chkActiveEmployee").attr("checked", e.IsActive); $("#chkIsReadiness").attr("checked", e.IsReadiness); $("#txtAdditionalInfoRemarks").text(e.PersonRemarks); $("#lblNameContaner").text(e.Person_FirstName + " " + e.Person_LastName); $("#txtExtSourceID1").val(e.Person_ExtSourceID1); $("#txtExtSourceID2").val(e.Person_ExtSourceID2); $("#txtExtSourceID3").val(e.Person_ExtSourceID3); if (!isNaN(e.Person_Age)) { $("#lblAge").text(e.Person_Age); $("#spanAge").removeClass("no-display") } else { $("#spanAge").addClass("no-display") } if (e.IsExistPersonPhoto) { employeePages.LoadPhoto(t) } else { $(t).attr("src", "/opeReady/Resources/images/defaultUser.jpg"); $("#loader").removeClass("loading").append(t) } $("#waitplease").css({ display: "none" }) }, function (e) { }) } else { $(t).attr("src", "/opeReady/Resources/images/defaultUser.jpg"); $("#loader").removeClass("loading").append(t); $("#btnUpdate").val($("#hidAdd").text()); $("#chkActiveEmployee").attr("checked", true); $("#chkIsReadiness").attr("checked", true) } }; employeePages.CheckEmployeeNumber = function (e) { var t = new Boolean(false); $("#txtEmployeeID").addClass("ui-autocomplete-loading"); var n = getArgs(); if (n.eid == undefined) { PQ.Admin.WebService.PQWebService.Person_CheckPersonNumber(e, function (e) { $("#waitplease").css({ display: "none" }); if (e) { $("#txtEmployeeID").removeClass("ui-autocomplete-loading").addClass("ui-state-error").focus(); $("#divEmployeeIDIsExist").removeClass("no-display"); return false } else { $("#divEmployeeIDIsExist").addClass("no-display"); $("#txtEmployeeID").removeClass("ui-state-error ui-autocomplete-loading"); employeePages.EmployeeDetailsSave() } }, function (e) { $("#waitplease").css({ display: "none" }); return false }) } else { setTimeout(function () { $("#txtEmployeeID").removeClass("ui-autocomplete-loading") }, 500); employeePages.EmployeeDetailsSave() } return false }; employeePages.EmployeeDetailsSave = function () { $("#waitplease").css({ display: "block" }); var e = { Person_ID: parseInt($("#txtEmployeeID").val()), Person_FirstName: $("#txtFirstNameDetails").val(), Person_LastName: $("#txtLastNameDetails").val(), Person_MiddleName: $("#txtMiddleNameDetails").val(), PersonCategory_ID: $("#ddlClassification").val(), Person_OrganizationID: $("#txtOrganizationID").val(), PersonBirthDateStr: $("#txtBirthDay").val(), Person_Tel1: $("#txtPhone").val(), Person_Tel2: $("#txtCellular").val(), Person_Tel3: $("#txtFax").val(), Person_Address1: $("#txtCity").val(), Person_Address2: $("#txtStreet").val(), Person_Address3: $("#txtApartment").val(), Person_Email: $("#txtEmail").val(), PersonRemarks: $("#txtAdditionalInfoRemarks").val(), IsReadiness: $("#chkIsReadiness").attr("checked"), IsActive: $("#chkActiveEmployee").attr("checked"), Person_ExtSourceID1: $("#txtExtSourceID1").val(), Person_ExtSourceID2: $("#txtExtSourceID2").val(), Person_ExtSourceID3: $("#txtExtSourceID3").val() }; PQ.Admin.WebService.PQWebService.Person_Save(e, function (e) { if (e) { window.location = employeePages.employeeDetailsPath + "?eid=" + e } else { employeePages.LoadEmployeeDetailsGeneral() } $("#waitplease").css({ display: "none" }) }, function (e) { $("#waitplease").css({ display: "none" }) }); return false }; employeePages.EmployeeDetails_DeleteEmployee = function () { var e = getArgs(); if (e.eid) { $("#divConfirmDeleteEmployee").dialog({ autoOpen: true, modal: true, resizable: false, closeOnEscape: true, height: 150, open: function (e, t) { $(this).parent().appendTo("form"); $("#txtConfirmDelete").removeClass("ui-state-error").val("") }, buttons: { Ok: function (t) { t.preventDefault(); try { $("<div></div>").addClass("dialog").attr("id", "divConfirmDelete2").appendTo("body").dialog({ close: function () { $(this).remove() }, modal: true, buttons: { Ok: function () { PQ.Admin.WebService.PQWebService.Person_Delete(e.eid, function (e) { if (e) { window.location = employeePages.employeeListPage } $("#waitplease").css({ display: "none" }) }, function (e) { $("#waitplease").css({ display: "none" }) }) }, Cancel: function () { $(this).dialog("close") } } }) } catch (t) { return false } return false }, Cancel: function (e) { e.preventDefault(); $(this).dialog("destroy"); return false } } }) } }; employeePages.CheckRequaredFields = function () { var e = new Boolean(true); if ($("#txtFirstNameDetails").val().trim() == "") { $("#txtFirstNameDetails").addClass("ui-state-error").focus(); $("#waitplease").css({ display: "none" }); e = false; return false } else { $("#txtFirstNameDetails").removeClass("ui-state-error", 500) } if ($("#txtLastNameDetails").val().trim() == "") { $("#txtLastNameDetails").addClass("ui-state-error").focus(); $("#waitplease").css({ display: "none" }); return false; e = false } else { $("#txtLastNameDetails").removeClass("ui-state-error", 500) } if ($("#txtEmployeeID").val().trim() == "") { $("#txtEmployeeID").addClass("ui-state-error").focus(); $("#waitplease").css({ display: "none" }); e = false; return false } else { if (!employeePages.CheckEmployeeNumber($("#txtEmployeeID").val())) { e = false; return false } } return e }; employeePages.LoadPhoto = function (e) { var t = new Date; t = encodeURI(t.toString()); var n = getArgs(); if (n.eid) { $(e).hide(); $(e).attr("src", "/opeReady/Handlers/PhotoHandler.ashx?eid=" + n.eid + "&d=" + t); $(e).waitForImages(function () { $("#loader").removeClass("loading").append(e); $(e).fadeIn() }) } else { $(e).attr("src", "/opeReady/Resources/images/defaultUser.jpg?d=" + t); $(e).waitForImages(function () { $("#loader").removeClass("loading").append(e); $(e).fadeIn() }) } }; employeePages.imgEditCurrActiveJob_click = function (e) { if (e) { var t = e.Job_ID; $("#txtFromDateJobHistory").val(e.Person2Job_FromDateStr).attr("readonly", "readonly").datepicker("destroy"); $("#txtToDateJobHistory").val(e.Person2Job_ToDateStr); $("#ddlJob").val(e.Job_ID).hide(); $("#txtJobName").val(e.Job_Name).show(); $("#txtJobStatus").val(e.JobStatus_ORGName).show(); $("#ddlJobStatus").val(e.JobStatus_ID).hide(); $("#btnAddJobHistory").val($("#hidUpdate").text()) } else { $("#txtFromDateJobHistory").datepicker({ changeYear: true, changeMonth: true, dateFormat: dateFormats }).val("").removeAttr("readonly"); $("#txtToDateJobHistory").val(""); $("#txtJobName").hide(); $("#ddlJob").val("0").show(); $("#ddlJobStatus").val("0").show(); $("#txtJobStatus").val("").hide(); $("#btnAddJobHistory").val($("#hidAdd").text()) } divJobHistoryEdit_Open(); return false }; employeePages.UnitItemHistoryDelete = function (e, t, n, r) { $("#divUnitHistoryEdit").dialog("destroy") }; employeePages.TabPopulateSelector = function (e) { if (e) { switch (e) { case 0: employeePages.LoadEmployeeDetailsGeneral(); $("#divNameContaner").addClass("no-display", 100); break; case 1: $("#gvEmlpoymentHistory").GridUnload(); employmentHistory.CreateAndPopulateEmploymentHistoryGrid(); employmentHistory.PopulateEmploymentHistoryCombo(); $("#divNameContaner").removeClass("no-display", 500); break; case 4: $("#waitplease").css({ display: "block" }); var t = getArgs(); if (t.eid) { unitJob.ReloadCurrentActiveJob(t.eid); unitJob.ReloadCurrentActiveUnit(t.eid) } $("#tblJobHistory").GridUnload(); unitJob.CreateAndPopulateJobUnitGrid(); $("#tblUnitHistory").GridUnload(); unitJob.CreateAndPopulateUnitHistoryGrid(); unitJob.PopulateJobStatusCombo(); unitJob.PopulateJobCategoryCombo(); $("#divNameContaner").removeClass("no-display", 500); break; case 5: $("#waitplease").css({ display: "block" }); $("#tblEventHistory").GridUnload(); _trainEvTypeID = _trainEvTypeID == undefined ? null : _trainEvTypeID; _evTypeID = $("#hidEventTypeID").val() == "" ? null : parseInt($("#hidEventTypeID").val()); CreateAndPopulateEventRecordsGrid(_trainEvTypeID, _evTypeID); eventRecords.PopulateTrainingEventTypeCombo(); eventRecords.PopulatlPerfomanceLevelCombo(); $("#divNameContaner").removeClass("no-display", 100); break; case 2: $("#tblAdminTask").GridUnload(); administrativeTasks.CreateAndPopulateAdminTasksGrid(); administrativeTasks.PopulateAdminTasksCombo(); $("#divNameContaner").removeClass("no-display", 500); break; case 3: $("#tlbPersonAttachments").GridUnload(); attachment.CreateAttachmentGrid(); $("#divNameContaner").removeClass("no-display", 500); break; case 7: $("#waitplease").css({ display: "block" }); readinessInfo.GetReadinessDetails(); var t = getArgs(); if (t.eid) { readinessInfo.ChrtReadinessStatusHistory(t.eid) } document.getElementById("frmGauges").contentWindow.location.reload(true); $("#divNameContaner").removeClass("no-display", 500); $("#waitplease").css({ display: "none" }); break; case 6: $("#waitplease").css({ display: "block" }); perfomance.PopulateTrainingEventTypeCombo(); $("#divNameContaner").removeClass("no-display", 500); break } } }; employeePages.ReviewGauges = function () { if (this.pathSrc) { $("#frmGauges").attr("src", this.pathSrc); $("#waitplease").css({ display: "none" }) } }; employeePages.GetCurrentEmployeeQty = function () { var e = new Boolean(false); $.ajax({ type: "POST", url: "/opeReady/WebService/PQWebService.asmx/GetCurrentEmployeeQty", contentType: "application/json; charset=utf-8", async: false, dataType: "json", success: function (t) { var n = parseInt($("#hidEmp").val()); if (n <= getMain(t)) { e = true; $("#btnUpdate").attr("disabled", false) } else { $("#btnUpdate").attr("disabled", true) } }, error: function (t) { e = false } }); return e }; Sys.Application.add_load(applicationLoadHandler); Sys.WebForms.PageRequestManager.getInstance().add_endRequest(endRequestHandler); Sys.WebForms.PageRequestManager.getInstance().add_beginRequest(beginRequestHandler);