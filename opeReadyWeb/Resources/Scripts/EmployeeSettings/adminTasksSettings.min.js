var rowCount; var adminTask = {}; adminTask.CreateAdministrativeRequirementsGrid = function () { var a; if ($.cookie("lang")) { if ($.cookie("lang") == "he-IL" || $.cookie("lang") == "ar") a = "rtl"; else a = "ltr" } $("#divAdminTask").block({ css: { border: "0px" }, overlayCSS: { backgroundColor: "#ffffff", opacity: .7 }, message: "" }); $("#tblAdminTask").jqGrid({ direction: a, datatype: function (a) { adminTask.getAdminTaskData(a) }, height: 375, autowidth: false, colNames: [$("#hidAdminTask_Grid_AdministrativeRequirements_Name").text(), "", "", "SubQualificationType_ID"], colModel: [{ name: "SubQualificationType_Name", index: "SubQualificationType_Name", sortable: true, width: 350 }, { name: "EditAdTask", index: "EditAdTask", sortable: false, edittype: "image", formatter: editFormatter, width: 32, align: "center" }, { name: "DelAdTask", index: "DelAdTask", sortable: false, edittype: "image", formatter: deleteFormatter, width: 45, align: "center" }, { name: "SubQualificationType_ID", hidden: "true", key: true}], imgpath: '<%= ResolveClientUrl("~/Resources/Styles/redmon/images") %>', datefmt: "d/m/Y", viewrecords: true, sortorder: "desc", autoencode: false, loadonce: false, pginput: true, recordpos: "left", altRows: true, hoverrows: false, toolbar: [true, "top"], pager: "#pgrAdminTask", pgbuttons: false, pginput: false, gridComplete: function () { $(this).setGridParam({ datatype: "local", selarrrow: "false" }); if (rowCount == $(this).getGridParam("records")) { $("#waitplease").css({ display: "none" }); $("#divAdminTask").unblock() } }, onCellSelect: function (a, b, c, d) { switch (b) { case 1: adminTask.AdministrativeTasksEdit_Update($(this).getRowData(a)); break; case 2: return adminTask.DeleteAdministrativeTask($(this).getRowData(a).SubQualificationType_ID); break } return false }, ondblClickRow: function (a, b, c, d) { adminTask.AdministrativeTasksEdit_Update($(this).getRowData(a)) } }); $("#tblAdminTask").jqGrid("gridResize", { minWidth: 674, minHeight: 300 }); $("#tblAdminTask").toolbarButtonAdd("#t_tblAdminTask", { caption: $("#hidAdminTask_btnAddNewAdministrativeRequirements").text(), position: "first", align: a == "rtl" ? "right" : "left", buttonicon: "ui-icon-circle-plus", onClickButton: function () { adminTask.AdministrativeTasksEdit_New() } }) }; adminTask.getAdminTaskData = function (a) { PQ.Admin.WebService.EmployeeSettingsService.SubQualificationType_SelectAll(function (a, b) { adminTask.ReceivedAdminTaskData(JSON.parse(getMain(a)).rows) }, function (a) { return false }) }; adminTask.ReceivedAdminTaskData = function (a) { var b = $("#tblAdminTask"); b.clearGridData(); rowCount = a.length; if (!rowCount) $("#divAdminTask").unblock(); for (var c = 0; c < a.length; c++) b.addRowData(c + 1, a[c]) }; adminTask.AdministrativeTasksEdit_Update = function (a) { $("#hidSubQualificationTypeID").val(a.SubQualificationType_ID); $("#txtAdministrativeRequirementsName").val(a.SubQualificationType_Name); $("#btnAddAdminTaskType").val($("#hidAdminTask_btnUpdateSetting").text()); divAdministrativeRequirements_Open() }; adminTask.DeleteAdministrativeTask = function (a) { if (a) { $("#ConfirmDeleteAttachment").dialog({ autoOpen: true, modal: true, resizable: false, closeOnEscape: true, height: 150, open: function (a, b) { $(this).parent().appendTo("form") }, buttons: { Ok: function (b) { b.preventDefault(); $("#waitplease").css({ display: "block" }); try { PQ.Admin.WebService.EmployeeSettingsService.SubQualificationType_Delete(a, function (a) { if (a) { $("#tblAdminTask").GridUnload(); adminTask.CreateAdministrativeRequirementsGrid(); $("#waitplease").css({ display: "none" }); $("#ConfirmDeleteAttachment").dialog("destroy") } }, function (a) { $("#waitplease").css({ display: "none" }); $("#ConfirmDeleteAttachment").dialog("destroy"); return false }) } catch (b) { return false } return false }, Cancel: function (a) { a.preventDefault(); $(this).dialog("destroy"); return false } } }) } return false }; adminTask.AdministrativeTasksEdit_New = function () { $("#txtAdministrativeRequirementsName").val(""); $("#hidSubQualificationTypeID").val(""); $("#btnAddAdminTaskType").val($("#hidAdminTask_btnAddAdminTask").text()); divAdministrativeRequirements_Open() };adminTask.AdministrativeTasksEdit_Save = function (a) { PQ.Admin.WebService.EmployeeSettingsService.SubQualificationType_Save(a, function (a) { if (a) { $("#tblAdminTask").GridUnload(); adminTask.CreateAdministrativeRequirementsGrid(); $("#divAdminTaskDetails").dialog("destroy") } $("#waitplease").css({ display: "none" }) }, function (a) { $("#waitplease").css({ display: "none" }); return false }) };